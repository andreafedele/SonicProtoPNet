training set size: 18000
push set size: 1500
test set size: 500
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	567.3881418704987
	cross ent: 	3.4253649258613588
	cluster: 	1.1680188468346993
	separation:	0.8359848930893673
	avg separation:	10.714868371751573
	accu: 		14.16111111111111%
	l1: 		12750.0
	p dist pair: 	22.37274742126465
	test
	time: 	9.709861993789673
	cross ent: 	3.036903963088989
	cluster: 	0.19916997253894805
	separation:	0.0714882680773735
	avg separation:	10.767296447753907
	accu: 		20.0%
	l1: 		12750.0
	p dist pair: 	22.37274742126465
epoch: 	1
	warm
	train
	time: 	384.3796977996826
	cross ent: 	2.8030017121632893
	cluster: 	0.1873919894463486
	separation:	0.07034963659114307
	avg separation:	9.998087001376682
	accu: 		25.683333333333337%
	l1: 		12750.0
	p dist pair: 	20.000024795532227
	test
	time: 	10.581775426864624
	cross ent: 	2.6177605485916136
	cluster: 	0.18349364012479782
	separation:	0.06680282682180405
	avg separation:	9.170100364685059
	accu: 		29.4%
	l1: 		12750.0
	p dist pair: 	20.000024795532227
epoch: 	2
	warm
	train
	time: 	401.128075838089
	cross ent: 	2.260220974948671
	cluster: 	0.18114610414538118
	separation:	0.0818656604240338
	avg separation:	8.479654089609783
	accu: 		37.333333333333336%
	l1: 		12750.0
	p dist pair: 	18.175840377807617
	test
	time: 	7.168259620666504
	cross ent: 	2.4061203622817993
	cluster: 	0.19485132336616517
	separation:	0.07890080451965333
	avg separation:	7.97308801651001
	accu: 		33.6%
	l1: 		12750.0
	p dist pair: 	18.175840377807617
epoch: 	3
	warm
	train
	time: 	266.5173065662384
	cross ent: 	1.9151434833473628
	cluster: 	0.17611863891283672
	separation:	0.08583338908851147
	avg separation:	7.551843565305074
	accu: 		45.53333333333333%
	l1: 		12750.0
	p dist pair: 	16.925411224365234
	test
	time: 	7.486569881439209
	cross ent: 	2.0945732307434084
	cluster: 	0.2018314090371132
	separation:	0.09173355221748353
	avg separation:	7.176033916473389
	accu: 		39.800000000000004%
	l1: 		12750.0
	p dist pair: 	16.925411224365234
epoch: 	4
	warm
	train
	time: 	272.03582191467285
	cross ent: 	1.6960038415590921
	cluster: 	0.1771956491470337
	separation:	0.09002770339863168
	avg separation:	6.793624671300252
	accu: 		50.99444444444444%
	l1: 		12750.0
	p dist pair: 	15.587323188781738
	test
	time: 	6.500265598297119
	cross ent: 	2.1099307107925416
	cluster: 	0.1891696810722351
	separation:	0.09049641519784928
	avg separation:	6.420323276519776
	accu: 		41.6%
	l1: 		12750.0
	p dist pair: 	15.587323188781738
epoch: 	5
	joint
	train
	time: 	243.44933032989502
	cross ent: 	2.939083081881205
	cluster: 	0.24512562330398294
	separation:	0.10201495454129246
	avg separation:	7.428829780154758
	accu: 		20.3%
	l1: 		12750.0
	p dist pair: 	17.41086196899414
	test
	time: 	7.118413925170898
	cross ent: 	2.4592870712280273
	cluster: 	0.19958974063396454
	separation:	0.09821737766265869
	avg separation:	7.529348907470703
	accu: 		32.0%
	l1: 		12750.0
	p dist pair: 	17.41086196899414
	push
	Executing push ...
	push time: 	1037.7472686767578
	test
	time: 	6.424116611480713
	cross ent: 	8.738687763214111
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		20.8%
	l1: 		12750.0
	p dist pair: 	7.206711769104004
	last layer
iteration: 	0
	train
	time: 	227.57769799232483
	cross ent: 	4.34012534711096
	cluster: 	0.06410379397372405
	separation:	0.014846634586445159
	avg separation:	2.669111442565918
	accu: 		33.03333333333333%
	l1: 		12585.96875
	p dist pair: 	7.206711769104004
	test
	time: 	6.5936667919158936
	cross ent: 	3.607088718414307
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		37.6%
	l1: 		12585.96875
	p dist pair: 	7.206711769104004
iteration: 	1
	train
	time: 	209.24638414382935
	cross ent: 	3.1195941535631815
	cluster: 	0.06410379396544562
	separation:	0.014846634575062329
	avg separation:	2.669111432499356
	accu: 		39.711111111111116%
	l1: 		12563.126953125
	p dist pair: 	7.206711769104004
	test
	time: 	6.504671335220337
	cross ent: 	3.390088882446289
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		37.2%
	l1: 		12563.126953125
	p dist pair: 	7.206711769104004
iteration: 	2
	train
	time: 	211.83544373512268
	cross ent: 	2.875246631966697
	cluster: 	0.06410379393440153
	separation:	0.014846634576097131
	avg separation:	2.6691114319695366
	accu: 		41.41111111111111%
	l1: 		12543.3447265625
	p dist pair: 	7.206711769104004
	test
	time: 	6.513685464859009
	cross ent: 	3.198472490310669
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		38.0%
	l1: 		12543.3447265625
	p dist pair: 	7.206711769104004
iteration: 	3
	train
	time: 	210.22920393943787
	cross ent: 	2.6852624312374327
	cluster: 	0.06410379390335745
	separation:	0.014846634571440517
	avg separation:	2.6691114343537223
	accu: 		42.95%
	l1: 		12522.724609375
	p dist pair: 	7.206711769104004
	test
	time: 	6.650893449783325
	cross ent: 	3.01918625831604
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		39.6%
	l1: 		12522.724609375
	p dist pair: 	7.206711769104004
iteration: 	4
	train
	time: 	210.57833576202393
	cross ent: 	2.5270113127099143
	cluster: 	0.06410379389507903
	separation:	0.01484663456885351
	avg separation:	2.6691114309098984
	accu: 		44.49444444444444%
	l1: 		12500.373046875
	p dist pair: 	7.206711769104004
	test
	time: 	6.665371894836426
	cross ent: 	2.9078897428512573
	cluster: 	0.06654290840029717
	separation:	0.014112549163401126
	avg separation:	2.626835880279541
	accu: 		40.8%
	l1: 		12500.373046875
	p dist pair: 	7.206711769104004
epoch: 	6
	joint
	train
	time: 	243.58172059059143
	cross ent: 	1.8707324995597203
	cluster: 	0.18205697557164563
	separation:	0.0757003375981003
	avg separation:	3.871406915717655
	accu: 		46.21111111111111%
	l1: 		12500.373046875
	p dist pair: 	10.601784706115723
	test
	time: 	6.6192626953125
	cross ent: 	1.8694382047653197
	cluster: 	0.18829168915748595
	separation:	0.0818031319975853
	avg separation:	4.07211275100708
	accu: 		47.599999999999994%
	l1: 		12500.373046875
	p dist pair: 	10.601784706115723
epoch: 	7
	joint
	train
	time: 	240.93476605415344
	cross ent: 	1.1106858552826775
	cluster: 	0.14868154857721594
	separation:	0.07634023821602265
	avg separation:	4.166468722820282
	accu: 		66.42222222222223%
	l1: 		12500.373046875
	p dist pair: 	10.88490104675293
	test
	time: 	6.50080132484436
	cross ent: 	1.4181370329856873
	cluster: 	0.16974914878606795
	separation:	0.07353250205516815
	avg separation:	4.269272956848145
	accu: 		59.8%
	l1: 		12500.373046875
	p dist pair: 	10.88490104675293
	above 50.00%
epoch: 	8
	joint
	train
	time: 	240.78313159942627
	cross ent: 	0.7974982779224714
	cluster: 	0.13503002718091012
	separation:	0.07784585643559694
	avg separation:	4.196827929549747
	accu: 		75.88888888888889%
	l1: 		12500.373046875
	p dist pair: 	10.851112365722656
	test
	time: 	6.62189507484436
	cross ent: 	1.7062570762634277
	cluster: 	0.16247864067554474
	separation:	0.06983744949102402
	avg separation:	4.0658910274505615
	accu: 		55.60000000000001%
	l1: 		12500.373046875
	p dist pair: 	10.851112365722656
	above 50.00%
epoch: 	9
	joint
	train
	time: 	240.87310242652893
	cross ent: 	0.598618261081477
	cluster: 	0.1214143143263128
	separation:	0.072208843678236
	avg separation:	4.152192153135935
	accu: 		81.50555555555556%
	l1: 		12500.373046875
	p dist pair: 	10.71998119354248
	test
	time: 	6.5718300342559814
	cross ent: 	1.2518374919891357
	cluster: 	0.13863055527210236
	separation:	0.06970611706376076
	avg separation:	4.085145444869995
	accu: 		66.2%
	l1: 		12500.373046875
	p dist pair: 	10.71998119354248
	above 50.00%
epoch: 	10
	joint
	train
	time: 	240.7460536956787
	cross ent: 	0.14903386560993062
	cluster: 	0.07167980744192998
	separation:	0.059224833328690794
	avg separation:	4.059076353973812
	accu: 		96.03888888888889%
	l1: 		12500.373046875
	p dist pair: 	10.54743480682373
	test
	time: 	6.537791013717651
	cross ent: 	1.0497723257541656
	cluster: 	0.08102752849459648
	separation:	0.04615402296185493
	avg separation:	3.9381275081634524
	accu: 		74.8%
	l1: 		12500.373046875
	p dist pair: 	10.54743480682373
	above 50.00%
	push
	Executing push ...
	push time: 	1030.6040534973145
	test
	time: 	7.2509706020355225
	cross ent: 	1.72331951379776
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		70.0%
	l1: 		12500.373046875
	p dist pair: 	9.17104434967041
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	209.95143604278564
	cross ent: 	0.15514816218573185
	cluster: 	0.03518031500486864
	separation:	0.02774926210443179
	avg separation:	3.413043428791894
	accu: 		94.81111111111112%
	l1: 		12481.416015625
	p dist pair: 	9.17104434967041
	test
	time: 	6.5540478229522705
	cross ent: 	1.4774898064136506
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		72.2%
	l1: 		12481.416015625
	p dist pair: 	9.17104434967041
	above 50.00%
iteration: 	1
	train
	time: 	209.36587619781494
	cross ent: 	0.11620360640718394
	cluster: 	0.03518031503798233
	separation:	0.027749262077526912
	avg separation:	3.413043424023522
	accu: 		96.09444444444445%
	l1: 		12450.9228515625
	p dist pair: 	9.17104434967041
	test
	time: 	6.6596519947052
	cross ent: 	1.4328912830352782
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		71.8%
	l1: 		12450.9228515625
	p dist pair: 	9.17104434967041
	above 50.00%
iteration: 	2
	train
	time: 	206.02214670181274
	cross ent: 	0.10528538958861544
	cluster: 	0.03518031499659022
	separation:	0.02774926209822297
	avg separation:	3.413043433030446
	accu: 		96.50555555555556%
	l1: 		12407.2783203125
	p dist pair: 	9.17104434967041
	test
	time: 	6.653716325759888
	cross ent: 	1.4087618577480316
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		72.39999999999999%
	l1: 		12407.2783203125
	p dist pair: 	9.17104434967041
	above 50.00%
iteration: 	3
	train
	time: 	210.02246809005737
	cross ent: 	0.09822049630307851
	cluster: 	0.03518031500486864
	separation:	0.027749262059935265
	avg separation:	3.4130434205796982
	accu: 		96.81111111111112%
	l1: 		12347.7265625
	p dist pair: 	9.17104434967041
	test
	time: 	6.731406211853027
	cross ent: 	1.383745050430298
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		72.6%
	l1: 		12347.7265625
	p dist pair: 	9.17104434967041
	above 50.00%
iteration: 	4
	train
	time: 	209.09240698814392
	cross ent: 	0.09143453252171942
	cluster: 	0.0351803150276343
	separation:	0.027749262069248493
	avg separation:	3.4130434290568035
	accu: 		97.05555555555556%
	l1: 		12272.421875
	p dist pair: 	9.17104434967041
	test
	time: 	6.907054662704468
	cross ent: 	1.357865525484085
	cluster: 	0.05292768999934196
	separation:	0.022981140725314618
	avg separation:	3.3364445781707763
	accu: 		73.2%
	l1: 		12272.421875
	p dist pair: 	9.17104434967041
	above 50.00%
epoch: 	11
	joint
	train
	time: 	243.30620336532593
	cross ent: 	0.06693898441638642
	cluster: 	0.036942803907311625
	separation:	0.032775258148709935
	avg separation:	3.4002127793100145
	accu: 		98.06666666666666%
	l1: 		12272.421875
	p dist pair: 	9.131096839904785
	test
	time: 	6.89707612991333
	cross ent: 	1.225393238067627
	cluster: 	0.052879014015197755
	separation:	0.02908784545958042
	avg separation:	3.3208715438842775
	accu: 		74.2%
	l1: 		12272.421875
	p dist pair: 	9.131096839904785
	above 50.00%
epoch: 	12
	joint
	train
	time: 	240.7135841846466
	cross ent: 	0.029923686398542485
	cluster: 	0.031201242374049292
	separation:	0.03186491660152872
	avg separation:	3.3651268702083166
	accu: 		99.32777777777778%
	l1: 		12272.421875
	p dist pair: 	9.056990623474121
	test
	time: 	6.624321699142456
	cross ent: 	1.2076466000080108
	cluster: 	0.04953553855419159
	separation:	0.02661883592605591
	avg separation:	3.269436254501343
	accu: 		74.2%
	l1: 		12272.421875
	p dist pair: 	9.056990623474121
	above 50.00%
epoch: 	13
	joint
	train
	time: 	240.66313767433167
	cross ent: 	0.016423266425327814
	cluster: 	0.026196608692407607
	separation:	0.029219396871825058
	avg separation:	3.319426062901815
	accu: 		99.77777777777777%
	l1: 		12272.421875
	p dist pair: 	8.958656311035156
	test
	time: 	6.790862560272217
	cross ent: 	1.2459649765491485
	cluster: 	0.04707980439066887
	separation:	0.025118515193462372
	avg separation:	3.2275224781036376
	accu: 		75.2%
	l1: 		12272.421875
	p dist pair: 	8.958656311035156
	above 50.00%
epoch: 	14
	joint
	train
	time: 	240.81363773345947
	cross ent: 	0.01841539392905866
	cluster: 	0.024695874481565423
	separation:	0.027722095081375703
	avg separation:	3.2715791487693786
	accu: 		99.63888888888889%
	l1: 		12272.421875
	p dist pair: 	8.868468284606934
	test
	time: 	6.417880058288574
	cross ent: 	1.3544940054416656
	cluster: 	0.04730383388698101
	separation:	0.023240082301199436
	avg separation:	3.1927200412750243
	accu: 		74.2%
	l1: 		12272.421875
	p dist pair: 	8.868468284606934
	above 50.00%
epoch: 	15
	joint
	train
	time: 	240.66936445236206
	cross ent: 	0.008106854136114837
	cluster: 	0.02238057195933329
	separation:	0.026532961114620168
	avg separation:	3.2478522247738306
	accu: 		99.95555555555555%
	l1: 		12272.421875
	p dist pair: 	8.859672546386719
	test
	time: 	6.855340242385864
	cross ent: 	1.3068090975284576
	cluster: 	0.04457226626574993
	separation:	0.022977356389164923
	avg separation:	3.1889469909667967
	accu: 		75.4%
	l1: 		12272.421875
	p dist pair: 	8.859672546386719
	above 50.00%
	push
	Executing push ...
	push time: 	1020.2568497657776
	test
	time: 	7.494810581207275
	cross ent: 	1.4050033700466156
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.6%
	l1: 		12272.421875
	p dist pair: 	8.563640594482422
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	207.20677375793457
	cross ent: 	0.012793843214215788
	cluster: 	0.020709285689517857
	separation:	0.020639010905805562
	avg separation:	3.139477744102478
	accu: 		99.80555555555556%
	l1: 		12162.802734375
	p dist pair: 	8.563640594482422
	test
	time: 	6.696481943130493
	cross ent: 	1.3796159994602204
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.6%
	l1: 		12162.802734375
	p dist pair: 	8.563640594482422
	above 50.00%
iteration: 	1
	train
	time: 	210.39847540855408
	cross ent: 	0.011379941285898289
	cluster: 	0.020709285689517857
	separation:	0.02063901090166635
	avg separation:	3.1394777496655784
	accu: 		99.87777777777778%
	l1: 		12005.634765625
	p dist pair: 	8.563640594482422
	test
	time: 	6.510488510131836
	cross ent: 	1.3790358245372771
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.2%
	l1: 		12005.634765625
	p dist pair: 	8.563640594482422
	above 50.00%
iteration: 	2
	train
	time: 	208.57241296768188
	cross ent: 	0.010974682123435034
	cluster: 	0.02070928569883108
	separation:	0.02063901091615359
	avg separation:	3.1394777504603066
	accu: 		99.87777777777778%
	l1: 		11792.1513671875
	p dist pair: 	8.563640594482422
	test
	time: 	6.595805644989014
	cross ent: 	1.3680779910087586
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.6%
	l1: 		11792.1513671875
	p dist pair: 	8.563640594482422
	above 50.00%
iteration: 	3
	train
	time: 	207.26474237442017
	cross ent: 	0.01070336910323628
	cluster: 	0.02070928567296101
	separation:	0.020639010918223195
	avg separation:	3.139477749135759
	accu: 		99.9%
	l1: 		11516.720703125
	p dist pair: 	8.563640594482422
	test
	time: 	6.776928901672363
	cross ent: 	1.3450146651268005
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.6%
	l1: 		11516.720703125
	p dist pair: 	8.563640594482422
	above 50.00%
iteration: 	4
	train
	time: 	207.1313202381134
	cross ent: 	0.010564188981831346
	cluster: 	0.020709285717457532
	separation:	0.020639010877865883
	avg separation:	3.1394777417182924
	accu: 		99.91666666666667%
	l1: 		11187.43359375
	p dist pair: 	8.563640594482422
	test
	time: 	6.726863145828247
	cross ent: 	1.3418592524528503
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.8%
	l1: 		11187.43359375
	p dist pair: 	8.563640594482422
	above 50.00%
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	6.515990257263184
	cross ent: 	1.3418592524528503
	cluster: 	0.04067927598953247
	separation:	0.017020737007260322
	avg separation:	3.0859007263183593
	accu: 		75.8%
	l1: 		11187.43359375
	p dist pair: 	8.563640594482422
	above 50.00%
Execution time (minutes): 184.08538917303085
