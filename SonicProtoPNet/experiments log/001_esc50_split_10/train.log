training set size: 3600
push set size: 300
test set size: 100
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	48.23878026008606
	cross ent: 	1.9361468268765343
	cluster: 	2.1462724135981666
	separation:	1.7540002940429582
	avg separation:	10.558612791697184
	accu: 		36.30555555555556%
	l1: 		550.0
	p dist pair: 	19.924421310424805
	test
	time: 	3.0107274055480957
	cross ent: 	1.6860631227493286
	cluster: 	0.3934891581535339
	separation:	0.2827774167060852
	avg separation:	9.930705261230468
	accu: 		44.0%
	l1: 		550.0
	p dist pair: 	19.924421310424805
epoch: 	1
	warm
	train
	time: 	52.37429356575012
	cross ent: 	1.3886373927195867
	cluster: 	0.22790185842249128
	separation:	0.22087411756316822
	avg separation:	9.86445173687405
	accu: 		54.11111111111111%
	l1: 		550.0
	p dist pair: 	20.134017944335938
	test
	time: 	3.0198757648468018
	cross ent: 	1.608333945274353
	cluster: 	0.22401290833950044
	separation:	0.14793464839458464
	avg separation:	9.792556190490723
	accu: 		44.0%
	l1: 		550.0
	p dist pair: 	20.134017944335938
epoch: 	2
	warm
	train
	time: 	42.73435854911804
	cross ent: 	1.1224378489785725
	cluster: 	0.13858751737409167
	separation:	0.15827458985149861
	avg separation:	9.604082043965658
	accu: 		62.94444444444445%
	l1: 		550.0
	p dist pair: 	19.78029441833496
	test
	time: 	2.3919098377227783
	cross ent: 	1.3368166923522948
	cluster: 	0.16039589345455169
	separation:	0.12681465446949006
	avg separation:	9.471618461608887
	accu: 		55.00000000000001%
	l1: 		550.0
	p dist pair: 	19.78029441833496
	above 50.00%
epoch: 	3
	warm
	train
	time: 	43.2418155670166
	cross ent: 	0.9073122733169132
	cluster: 	0.11642342648572392
	separation:	0.15640295727385414
	avg separation:	9.28826240433587
	accu: 		69.33333333333334%
	l1: 		550.0
	p dist pair: 	19.40107536315918
	test
	time: 	2.8238837718963623
	cross ent: 	1.1816336870193482
	cluster: 	0.14550873041152954
	separation:	0.13724609464406967
	avg separation:	9.170738029479981
	accu: 		59.0%
	l1: 		550.0
	p dist pair: 	19.40107536315918
	above 50.00%
epoch: 	4
	warm
	train
	time: 	42.51679253578186
	cross ent: 	0.7221996358699269
	cluster: 	0.10159005671739578
	separation:	0.15144320676724116
	avg separation:	9.002471288045248
	accu: 		76.86111111111111%
	l1: 		550.0
	p dist pair: 	18.99968147277832
	test
	time: 	2.485145330429077
	cross ent: 	1.3518520712852478
	cluster: 	0.11549583375453949
	separation:	0.117477647960186
	avg separation:	8.884911346435548
	accu: 		56.99999999999999%
	l1: 		550.0
	p dist pair: 	18.99968147277832
	above 50.00%
epoch: 	5
	joint
	train
	time: 	55.98593854904175
	cross ent: 	1.8402581880489985
	cluster: 	0.3207458679874738
	separation:	0.1986225053668022
	avg separation:	9.008387200037639
	accu: 		33.97222222222222%
	l1: 		550.0
	p dist pair: 	18.646635055541992
	test
	time: 	2.552733898162842
	cross ent: 	1.9086220741271973
	cluster: 	0.28161918818950654
	separation:	0.1359591692686081
	avg separation:	9.128903198242188
	accu: 		42.0%
	l1: 		550.0
	p dist pair: 	18.646635055541992
	push
	Executing push ...
	push time: 	194.64646196365356
	test
	time: 	2.461193323135376
	cross ent: 	7.55762996673584
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		22.0%
	l1: 		550.0
	p dist pair: 	2.065943956375122
	last layer
iteration: 	0
	train
	time: 	42.160780906677246
	cross ent: 	7.142855930328369
	cluster: 	0.05653741103079584
	separation:	0.015296078007668256
	avg separation:	0.8860914571417703
	accu: 		26.722222222222225%
	l1: 		544.9822998046875
	p dist pair: 	2.065943956375122
	test
	time: 	2.3348495960235596
	cross ent: 	5.331631278991699
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		34.0%
	l1: 		544.9822998046875
	p dist pair: 	2.065943956375122
iteration: 	1
	train
	time: 	40.5949022769928
	cross ent: 	5.477241387632158
	cluster: 	0.05653741098940372
	separation:	0.015296078033538328
	avg separation:	0.8860914578040441
	accu: 		33.77777777777778%
	l1: 		542.720458984375
	p dist pair: 	2.065943956375122
	test
	time: 	2.3120107650756836
	cross ent: 	4.289115571975708
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		39.0%
	l1: 		542.720458984375
	p dist pair: 	2.065943956375122
iteration: 	2
	train
	time: 	40.58391070365906
	cross ent: 	4.5386743797196285
	cluster: 	0.05653741085487935
	separation:	0.015296077950754099
	avg separation:	0.8860914525058534
	accu: 		35.94444444444444%
	l1: 		541.729736328125
	p dist pair: 	2.065943956375122
	test
	time: 	2.321074962615967
	cross ent: 	3.6509424686431884
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		42.0%
	l1: 		541.729736328125
	p dist pair: 	2.065943956375122
iteration: 	3
	train
	time: 	39.76874852180481
	cross ent: 	3.8568059586816363
	cluster: 	0.05653741089627147
	separation:	0.015296077981798186
	avg separation:	0.8860914574729072
	accu: 		36.916666666666664%
	l1: 		541.2473754882812
	p dist pair: 	2.065943956375122
	test
	time: 	2.2986037731170654
	cross ent: 	3.1771045207977293
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		44.0%
	l1: 		541.2473754882812
	p dist pair: 	2.065943956375122
iteration: 	4
	train
	time: 	40.07740259170532
	cross ent: 	3.333524192041821
	cluster: 	0.056537410916967526
	separation:	0.015296078018016286
	avg separation:	0.8860914584663179
	accu: 		37.19444444444445%
	l1: 		540.9677734375
	p dist pair: 	2.065943956375122
	test
	time: 	2.2985668182373047
	cross ent: 	2.840162658691406
	cluster: 	0.05310218781232834
	separation:	0.01605995185673237
	avg separation:	0.8433150529861451
	accu: 		44.0%
	l1: 		540.9677734375
	p dist pair: 	2.065943956375122
epoch: 	6
	joint
	train
	time: 	49.59869337081909
	cross ent: 	1.591561018427213
	cluster: 	0.1905165511286921
	separation:	0.1377661585031698
	avg separation:	1.3718165377775828
	accu: 		45.08333333333333%
	l1: 		540.9677734375
	p dist pair: 	3.0788960456848145
	test
	time: 	2.3131754398345947
	cross ent: 	1.5628236532211304
	cluster: 	0.09915962368249893
	separation:	0.061290742456912996
	avg separation:	1.3216774463653564
	accu: 		45.0%
	l1: 		540.9677734375
	p dist pair: 	3.0788960456848145
epoch: 	7
	joint
	train
	time: 	50.075273513793945
	cross ent: 	0.8051379730718004
	cluster: 	0.09428237879441845
	separation:	0.08680119348896874
	avg separation:	1.4978348731994628
	accu: 		71.25%
	l1: 		540.9677734375
	p dist pair: 	3.3687899112701416
	test
	time: 	2.3153867721557617
	cross ent: 	0.8793138325214386
	cluster: 	0.05939933881163597
	separation:	0.06455825865268708
	avg separation:	1.532357430458069
	accu: 		69.0%
	l1: 		540.9677734375
	p dist pair: 	3.3687899112701416
	above 50.00%
epoch: 	8
	joint
	train
	time: 	49.70791530609131
	cross ent: 	0.36445176732829876
	cluster: 	0.06411622899274032
	separation:	0.08742138269460864
	avg separation:	1.5252383258607654
	accu: 		87.63888888888889%
	l1: 		540.9677734375
	p dist pair: 	3.409008264541626
	test
	time: 	2.328598737716675
	cross ent: 	0.5003647923469543
	cluster: 	0.06050758436322212
	separation:	0.07529785186052322
	avg separation:	1.4993366479873658
	accu: 		80.0%
	l1: 		540.9677734375
	p dist pair: 	3.409008264541626
	above 50.00%
epoch: 	9
	joint
	train
	time: 	49.433441162109375
	cross ent: 	0.3339839699264202
	cluster: 	0.06260667915145555
	separation:	0.09438511060757769
	avg separation:	1.5789607458644443
	accu: 		89.13888888888889%
	l1: 		540.9677734375
	p dist pair: 	3.525346517562866
	test
	time: 	2.3222920894622803
	cross ent: 	0.4537051126360893
	cluster: 	0.05189483687281608
	separation:	0.07621841505169868
	avg separation:	1.5851306676864625
	accu: 		89.0%
	l1: 		540.9677734375
	p dist pair: 	3.525346517562866
	above 50.00%
epoch: 	10
	joint
	train
	time: 	49.313114166259766
	cross ent: 	0.06762539490979785
	cluster: 	0.036561877642654714
	separation:	0.09598996014230782
	avg separation:	1.5713844690057965
	accu: 		98.08333333333333%
	l1: 		540.9677734375
	p dist pair: 	3.5041511058807373
	test
	time: 	2.369453191757202
	cross ent: 	0.33867533802986144
	cluster: 	0.03743156529963017
	separation:	0.08224372863769532
	avg separation:	1.5499478816986083
	accu: 		91.0%
	l1: 		540.9677734375
	p dist pair: 	3.5041511058807373
	above 50.00%
	push
	Executing push ...
	push time: 	171.90463876724243
	test
	time: 	2.2391905784606934
	cross ent: 	0.7827067881822586
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		88.0%
	l1: 		540.9677734375
	p dist pair: 	2.534465789794922
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	42.39352345466614
	cross ent: 	0.3547896632862022
	cluster: 	0.014276377582508657
	separation:	0.02830620916146371
	avg separation:	1.0665297190348306
	accu: 		91.41666666666667%
	l1: 		540.7486572265625
	p dist pair: 	2.534465789794922
	test
	time: 	2.2249486446380615
	cross ent: 	0.6915295332670212
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		88.0%
	l1: 		540.7486572265625
	p dist pair: 	2.534465789794922
	above 50.00%
iteration: 	1
	train
	time: 	39.94355583190918
	cross ent: 	0.23562000485867934
	cluster: 	0.014276377629074785
	separation:	0.028306209202855825
	avg separation:	1.0665297143989139
	accu: 		93.52777777777777%
	l1: 		540.5333251953125
	p dist pair: 	2.534465789794922
	test
	time: 	2.2852988243103027
	cross ent: 	0.6378774613142013
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		89.0%
	l1: 		540.5333251953125
	p dist pair: 	2.534465789794922
	above 50.00%
iteration: 	2
	train
	time: 	41.16109275817871
	cross ent: 	0.17952943237356117
	cluster: 	0.014276377613552743
	separation:	0.02830620916146371
	avg separation:	1.066529710094134
	accu: 		94.75%
	l1: 		540.33984375
	p dist pair: 	2.534465789794922
	test
	time: 	2.2619969844818115
	cross ent: 	0.6085313826799392
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		90.0%
	l1: 		540.33984375
	p dist pair: 	2.534465789794922
	above 50.00%
iteration: 	3
	train
	time: 	40.354034662246704
	cross ent: 	0.14890018035010952
	cluster: 	0.014276377623900771
	separation:	0.028306209223551884
	avg separation:	1.0665297160545986
	accu: 		95.61111111111111%
	l1: 		540.166015625
	p dist pair: 	2.534465789794922
	test
	time: 	2.323657989501953
	cross ent: 	0.5910510048270226
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		90.0%
	l1: 		540.166015625
	p dist pair: 	2.534465789794922
	above 50.00%
iteration: 	4
	train
	time: 	40.14282989501953
	cross ent: 	0.13037909290125957
	cluster: 	0.014276377608378727
	separation:	0.028306209192507797
	avg separation:	1.0665297117498187
	accu: 		96.0%
	l1: 		539.9871826171875
	p dist pair: 	2.534465789794922
	test
	time: 	2.2482750415802
	cross ent: 	0.5797383159399032
	cluster: 	0.016345825232565402
	separation:	0.0302265178412199
	avg separation:	1.0448060154914856
	accu: 		90.0%
	l1: 		539.9871826171875
	p dist pair: 	2.534465789794922
	above 50.00%
epoch: 	11
	joint
	train
	time: 	49.68487358093262
	cross ent: 	0.0562915986137442
	cluster: 	0.016485146759077907
	separation:	0.03663359821463625
	avg separation:	1.0752654936578538
	accu: 		98.25%
	l1: 		539.9871826171875
	p dist pair: 	2.54757022857666
	test
	time: 	2.327996253967285
	cross ent: 	0.5397115349769592
	cluster: 	0.018994903564453124
	separation:	0.033345337584614755
	avg separation:	1.0549723386764527
	accu: 		89.0%
	l1: 		539.9871826171875
	p dist pair: 	2.54757022857666
	above 50.00%
epoch: 	12
	joint
	train
	time: 	50.157037019729614
	cross ent: 	0.024323064468100914
	cluster: 	0.014007799632640348
	separation:	0.03718922996065683
	avg separation:	1.0739543666442235
	accu: 		99.19444444444444%
	l1: 		539.9871826171875
	p dist pair: 	2.541903257369995
	test
	time: 	2.177037239074707
	cross ent: 	0.4815173089504242
	cluster: 	0.016725998371839523
	separation:	0.03552597090601921
	avg separation:	1.0503388404846192
	accu: 		92.0%
	l1: 		539.9871826171875
	p dist pair: 	2.541903257369995
	above 50.00%
epoch: 	13
	joint
	train
	time: 	49.87610459327698
	cross ent: 	0.02331086132024009
	cluster: 	0.0128956309467968
	separation:	0.040311424082352054
	avg separation:	1.0836641937494278
	accu: 		99.13888888888889%
	l1: 		539.9871826171875
	p dist pair: 	2.5419247150421143
	test
	time: 	2.319274663925171
	cross ent: 	0.4447451025247574
	cluster: 	0.015995331294834613
	separation:	0.038045883551239966
	avg separation:	1.0668023347854614
	accu: 		91.0%
	l1: 		539.9871826171875
	p dist pair: 	2.5419247150421143
	above 50.00%
epoch: 	14
	joint
	train
	time: 	49.717044830322266
	cross ent: 	0.015189163766828844
	cluster: 	0.011603559031047754
	separation:	0.041885512394623625
	avg separation:	1.0904401106966866
	accu: 		99.66666666666667%
	l1: 		539.9871826171875
	p dist pair: 	2.539801597595215
	test
	time: 	2.2408909797668457
	cross ent: 	0.4189583107829094
	cluster: 	0.01604583766311407
	separation:	0.03692817687988281
	avg separation:	1.0578396797180176
	accu: 		93.0%
	l1: 		539.9871826171875
	p dist pair: 	2.539801597595215
	above 50.00%
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	2.4317452907562256
	cross ent: 	0.4189583107829094
	cluster: 	0.01604583766311407
	separation:	0.03692817687988281
	avg separation:	1.0578396797180176
	accu: 		93.0%
	l1: 		539.9871826171875
	p dist pair: 	2.539801597595215
	above 50.00%
Execution time (minutes): 26.367118899027506
