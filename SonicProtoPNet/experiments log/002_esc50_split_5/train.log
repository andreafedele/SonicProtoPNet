training set size: 1800
push set size: 150
test set size: 50
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	56.252753257751465
	cross ent: 	1.542485523223877
	cluster: 	2.5528056767251757
	separation:	2.0348761750592126
	avg separation:	12.161903635660808
	accu: 		31.38888888888889%
	l1: 		150.0
	p dist pair: 	20.084468841552734
	test
	time: 	2.111658811569214
	cross ent: 	1.4578531583150227
	cluster: 	0.6274257699648539
	separation:	0.5607736110687256
	avg separation:	11.854231834411621
	accu: 		34.0%
	l1: 		150.0
	p dist pair: 	20.084468841552734
epoch: 	1
	warm
	train
	time: 	21.16577696800232
	cross ent: 	1.4212331308258905
	cluster: 	0.5086501088407305
	separation:	0.404324718647533
	avg separation:	11.695221530066597
	accu: 		39.83333333333333%
	l1: 		150.0
	p dist pair: 	19.53994369506836
	test
	time: 	1.8377678394317627
	cross ent: 	1.2767387231190999
	cluster: 	0.505554586648941
	separation:	0.4819156726201375
	avg separation:	10.675251324971518
	accu: 		54.0%
	l1: 		150.0
	p dist pair: 	19.53994369506836
	above 50.00%
epoch: 	2
	warm
	train
	time: 	21.36848473548889
	cross ent: 	1.3045753902859158
	cluster: 	0.3793686189585262
	separation:	0.33082367844051785
	avg separation:	10.739269108242459
	accu: 		46.94444444444444%
	l1: 		150.0
	p dist pair: 	18.983877182006836
	test
	time: 	1.758206844329834
	cross ent: 	1.1394680341084797
	cluster: 	0.3185497323671977
	separation:	0.3333296577135722
	avg separation:	10.14684804280599
	accu: 		62.0%
	l1: 		150.0
	p dist pair: 	18.983877182006836
	above 50.00%
epoch: 	3
	warm
	train
	time: 	20.894530534744263
	cross ent: 	1.1947353018654718
	cluster: 	0.3064833808276388
	separation:	0.28897074543767504
	avg separation:	9.881609153747558
	accu: 		53.77777777777778%
	l1: 		150.0
	p dist pair: 	18.281513214111328
	test
	time: 	1.8065605163574219
	cross ent: 	1.145628849665324
	cluster: 	0.27589328090349835
	separation:	0.2772575418154399
	avg separation:	9.515419642130533
	accu: 		60.0%
	l1: 		150.0
	p dist pair: 	18.281513214111328
	above 50.00%
epoch: 	4
	warm
	train
	time: 	21.040456771850586
	cross ent: 	1.1283399826950498
	cluster: 	0.291305915845765
	separation:	0.2816354680392477
	avg separation:	9.332504844665527
	accu: 		58.05555555555556%
	l1: 		150.0
	p dist pair: 	17.682085037231445
	test
	time: 	1.7812576293945312
	cross ent: 	1.0722076892852783
	cluster: 	0.2928015391031901
	separation:	0.2679719279209773
	avg separation:	8.932276089986166
	accu: 		60.0%
	l1: 		150.0
	p dist pair: 	17.682085037231445
	above 50.00%
epoch: 	5
	joint
	train
	time: 	24.953290700912476
	cross ent: 	1.5548497491412692
	cluster: 	0.7382447002662553
	separation:	0.40960858745707407
	avg separation:	8.816632948981391
	accu: 		29.388888888888886%
	l1: 		150.0
	p dist pair: 	17.315038681030273
	test
	time: 	1.7634830474853516
	cross ent: 	1.4205172459284465
	cluster: 	0.454251100619634
	separation:	0.32997359832127887
	avg separation:	8.638182957967123
	accu: 		28.000000000000004%
	l1: 		150.0
	p dist pair: 	17.315038681030273
	push
	Executing push ...
	push time: 	63.692591428756714
	test
	time: 	1.7422504425048828
	cross ent: 	5.648812135060628
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		40.0%
	l1: 		150.0
	p dist pair: 	0.781621515750885
	last layer
iteration: 	0
	train
	time: 	19.982410192489624
	cross ent: 	5.202609541681078
	cluster: 	0.0308637750438518
	separation:	0.011600469197663997
	avg separation:	0.19227362076441448
	accu: 		26.166666666666664%
	l1: 		149.69122314453125
	p dist pair: 	0.781621515750885
	test
	time: 	1.7679834365844727
	cross ent: 	4.834291378657023
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		40.0%
	l1: 		149.69122314453125
	p dist pair: 	0.781621515750885
iteration: 	1
	train
	time: 	20.713902473449707
	cross ent: 	4.725795682271322
	cluster: 	0.030863775261160402
	separation:	0.01160046913040181
	avg separation:	0.19227362092998293
	accu: 		26.333333333333332%
	l1: 		149.4793701171875
	p dist pair: 	0.781621515750885
	test
	time: 	1.776965618133545
	cross ent: 	4.339929262797038
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		42.0%
	l1: 		149.4793701171875
	p dist pair: 	0.781621515750885
iteration: 	2
	train
	time: 	20.429420709609985
	cross ent: 	4.393503801027934
	cluster: 	0.030863775157680115
	separation:	0.011600469145923853
	avg separation:	0.19227362010214064
	accu: 		26.5%
	l1: 		149.31639099121094
	p dist pair: 	0.781621515750885
	test
	time: 	1.65328049659729
	cross ent: 	4.088176091512044
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		40.0%
	l1: 		149.31639099121094
	p dist pair: 	0.781621515750885
iteration: 	3
	train
	time: 	20.419078588485718
	cross ent: 	4.162771150800917
	cluster: 	0.030863775126636028
	separation:	0.01160046913040181
	avg separation:	0.19227361960543526
	accu: 		26.944444444444443%
	l1: 		149.20260620117188
	p dist pair: 	0.781621515750885
	test
	time: 	1.7054462432861328
	cross ent: 	4.0282191435496015
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		38.0%
	l1: 		149.20260620117188
	p dist pair: 	0.781621515750885
iteration: 	4
	train
	time: 	20.667912483215332
	cross ent: 	4.020158885584937
	cluster: 	0.030863775054199828
	separation:	0.011600469187315967
	avg separation:	0.192273620598846
	accu: 		27.611111111111107%
	l1: 		149.09580993652344
	p dist pair: 	0.781621515750885
	test
	time: 	1.7684309482574463
	cross ent: 	4.087024211883545
	cluster: 	0.01354039553552866
	separation:	0.007106781005859375
	avg separation:	0.14150570333003998
	accu: 		38.0%
	l1: 		149.09580993652344
	p dist pair: 	0.781621515750885
epoch: 	6
	joint
	train
	time: 	24.92462968826294
	cross ent: 	1.540551792913013
	cluster: 	0.5510830516409543
	separation:	0.38670166169500186
	avg separation:	1.092984259625276
	accu: 		41.0%
	l1: 		149.09580993652344
	p dist pair: 	0.9468879103660583
	test
	time: 	1.7467458248138428
	cross ent: 	1.1844330430030823
	cluster: 	0.07600619147221248
	separation:	0.06060053532322248
	avg separation:	0.5355824828147888
	accu: 		54.0%
	l1: 		149.09580993652344
	p dist pair: 	0.9468879103660583
	above 50.00%
epoch: 	7
	joint
	train
	time: 	25.007479429244995
	cross ent: 	0.8768230663405524
	cluster: 	0.08243638500571251
	separation:	0.06331410443203317
	avg separation:	0.6066304975085788
	accu: 		66.33333333333333%
	l1: 		149.09580993652344
	p dist pair: 	0.9643502831459045
	test
	time: 	1.7767727375030518
	cross ent: 	1.137245198090871
	cluster: 	0.04400774712363879
	separation:	0.034002939239144325
	avg separation:	0.5060243705908457
	accu: 		68.0%
	l1: 		149.09580993652344
	p dist pair: 	0.9643502831459045
	above 50.00%
epoch: 	8
	joint
	train
	time: 	25.17426609992981
	cross ent: 	0.7241218520535363
	cluster: 	0.07188992930783165
	separation:	0.06103079590118594
	avg separation:	0.6146758907371097
	accu: 		72.5%
	l1: 		149.09580993652344
	p dist pair: 	1.0505743026733398
	test
	time: 	1.6973381042480469
	cross ent: 	0.49760382374127704
	cluster: 	0.06831970190008481
	separation:	0.06550445531805356
	avg separation:	0.64909960826238
	accu: 		84.0%
	l1: 		149.09580993652344
	p dist pair: 	1.0505743026733398
	above 50.00%
epoch: 	9
	joint
	train
	time: 	25.235995531082153
	cross ent: 	0.4518768425616953
	cluster: 	0.05672570622215668
	separation:	0.05480308611359861
	avg separation:	0.624791830446985
	accu: 		84.16666666666667%
	l1: 		149.09580993652344
	p dist pair: 	1.0774842500686646
	test
	time: 	1.7205753326416016
	cross ent: 	0.8453889489173889
	cluster: 	0.04610875497261683
	separation:	0.038576509803533554
	avg separation:	0.5367787977059683
	accu: 		84.0%
	l1: 		149.09580993652344
	p dist pair: 	1.0774842500686646
	above 50.00%
epoch: 	10
	joint
	train
	time: 	25.19409441947937
	cross ent: 	0.14629780799150466
	cluster: 	0.03550421038849486
	separation:	0.0358458673581481
	avg separation:	0.5734504047367308
	accu: 		95.77777777777777%
	l1: 		149.09580993652344
	p dist pair: 	1.0723378658294678
	test
	time: 	1.7227025032043457
	cross ent: 	0.19852310419082642
	cluster: 	0.029209518805146217
	separation:	0.032900620251894
	avg separation:	0.5170066356658936
	accu: 		98.0%
	l1: 		149.09580993652344
	p dist pair: 	1.0723378658294678
	above 50.00%
	push
	Executing push ...
	push time: 	68.86311173439026
	test
	time: 	1.7155110836029053
	cross ent: 	3.748502810796102
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		64.0%
	l1: 		149.09580993652344
	p dist pair: 	0.4812212884426117
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	19.975348711013794
	cross ent: 	2.1524016072352725
	cluster: 	0.0030796390660624536
	separation:	0.004977192433499214
	avg separation:	0.21214517106612524
	accu: 		69.11111111111111%
	l1: 		149.1559600830078
	p dist pair: 	0.4812212884426117
	test
	time: 	1.7584922313690186
	cross ent: 	2.257722576459249
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		70.0%
	l1: 		149.1559600830078
	p dist pair: 	0.4812212884426117
	above 50.00%
iteration: 	1
	train
	time: 	20.072684049606323
	cross ent: 	1.3149100073199305
	cluster: 	0.003079639058301432
	separation:	0.0049771924425537385
	avg separation:	0.2121451735496521
	accu: 		76.66666666666667%
	l1: 		149.2233428955078
	p dist pair: 	0.4812212884426117
	test
	time: 	1.7120075225830078
	cross ent: 	1.558118184407552
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		78.0%
	l1: 		149.2233428955078
	p dist pair: 	0.4812212884426117
	above 50.00%
iteration: 	2
	train
	time: 	20.624037742614746
	cross ent: 	0.9198810888247357
	cluster: 	0.0030796390764104824
	separation:	0.004977192433499214
	avg separation:	0.21214517421192594
	accu: 		81.44444444444444%
	l1: 		149.30116271972656
	p dist pair: 	0.4812212884426117
	test
	time: 	1.7015008926391602
	cross ent: 	1.2753050525983174
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		84.0%
	l1: 		149.30116271972656
	p dist pair: 	0.4812212884426117
	above 50.00%
iteration: 	3
	train
	time: 	20.41801404953003
	cross ent: 	0.679852727552255
	cluster: 	0.003079639067355957
	separation:	0.004977192411509653
	avg separation:	0.21214517106612524
	accu: 		84.27777777777777%
	l1: 		149.3759307861328
	p dist pair: 	0.4812212884426117
	test
	time: 	1.7230339050292969
	cross ent: 	1.1365951498349507
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		86.0%
	l1: 		149.3759307861328
	p dist pair: 	0.4812212884426117
	above 50.00%
iteration: 	4
	train
	time: 	20.379712343215942
	cross ent: 	0.5169569928881376
	cluster: 	0.0030796390550676734
	separation:	0.004977192443847242
	avg separation:	0.21214517288737827
	accu: 		86.16666666666667%
	l1: 		149.43438720703125
	p dist pair: 	0.4812212884426117
	test
	time: 	1.74066162109375
	cross ent: 	1.0575878123442333
	cluster: 	0.003282419793928663
	separation:	0.0034469604725018144
	avg separation:	0.16642295817534128
	accu: 		86.0%
	l1: 		149.43438720703125
	p dist pair: 	0.4812212884426117
	above 50.00%
epoch: 	11
	joint
	train
	time: 	25.032470703125
	cross ent: 	0.20150674391382684
	cluster: 	0.015601488962096887
	separation:	0.02491613648728364
	avg separation:	0.2656137224700716
	accu: 		95.27777777777777%
	l1: 		149.43438720703125
	p dist pair: 	0.4893098771572113
	test
	time: 	1.7246825695037842
	cross ent: 	0.5191961781432232
	cluster: 	0.015965016558766365
	separation:	0.015740967355668545
	avg separation:	0.21113657454649606
	accu: 		94.0%
	l1: 		149.43438720703125
	p dist pair: 	0.4893098771572113
	above 50.00%
epoch: 	12
	joint
	train
	time: 	25.106006383895874
	cross ent: 	0.033135040359209396
	cluster: 	0.011557952268049121
	separation:	0.021951116321401464
	avg separation:	0.23682211223575805
	accu: 		99.16666666666667%
	l1: 		149.43438720703125
	p dist pair: 	0.487688809633255
	test
	time: 	1.7514228820800781
	cross ent: 	0.27084496275832254
	cluster: 	0.010360718083878359
	separation:	0.013432820638020834
	avg separation:	0.1845328857501348
	accu: 		92.0%
	l1: 		149.43438720703125
	p dist pair: 	0.487688809633255
	above 50.00%
epoch: 	13
	joint
	train
	time: 	25.1887104511261
	cross ent: 	0.02684712351571458
	cluster: 	0.008777262474824157
	separation:	0.01836716156038973
	avg separation:	0.22597550816006132
	accu: 		99.44444444444444%
	l1: 		149.43438720703125
	p dist pair: 	0.4858874976634979
	test
	time: 	1.7425580024719238
	cross ent: 	0.19520869354406992
	cluster: 	0.008493042240540186
	separation:	0.011691157085200151
	avg separation:	0.1844686766465505
	accu: 		94.0%
	l1: 		149.43438720703125
	p dist pair: 	0.4858874976634979
	above 50.00%
epoch: 	14
	joint
	train
	time: 	25.26776671409607
	cross ent: 	0.0154782076228811
	cluster: 	0.007465222809049818
	separation:	0.018139703809801073
	avg separation:	0.22793659137354957
	accu: 		99.6111111111111%
	l1: 		149.43438720703125
	p dist pair: 	0.4844982922077179
	test
	time: 	1.7148993015289307
	cross ent: 	0.3488880762209495
	cluster: 	0.00831260671839118
	separation:	0.011521657618383566
	avg separation:	0.18712161481380463
	accu: 		92.0%
	l1: 		149.43438720703125
	p dist pair: 	0.4844982922077179
	above 50.00%
epoch: 	15
	joint
	train
	time: 	25.335344791412354
	cross ent: 	0.006008328565642134
	cluster: 	0.006599261120168699
	separation:	0.017647879094713263
	avg separation:	0.22797705216540232
	accu: 		100.0%
	l1: 		149.43438720703125
	p dist pair: 	0.48465028405189514
	test
	time: 	1.7515742778778076
	cross ent: 	0.33946700432958704
	cluster: 	0.008174896395454804
	separation:	0.011482620301345984
	avg separation:	0.18248500923315683
	accu: 		92.0%
	l1: 		149.43438720703125
	p dist pair: 	0.48465028405189514
	above 50.00%
	push
	Executing push ...
	push time: 	68.78522205352783
	test
	time: 	1.7563939094543457
	cross ent: 	0.8640966912110647
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		88.0%
	l1: 		149.43438720703125
	p dist pair: 	0.48589882254600525
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	20.054599285125732
	cross ent: 	0.4677639198660876
	cluster: 	0.00310070467983476
	separation:	0.009076097423935102
	avg separation:	0.21168872341513634
	accu: 		90.88888888888889%
	l1: 		149.5435791015625
	p dist pair: 	0.48589882254600525
	test
	time: 	1.7250702381134033
	cross ent: 	0.837496226032575
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		88.0%
	l1: 		149.5435791015625
	p dist pair: 	0.48589882254600525
	above 50.00%
iteration: 	1
	train
	time: 	21.103999376296997
	cross ent: 	0.33785651044272524
	cluster: 	0.003100704666899724
	separation:	0.009076097418761088
	avg separation:	0.21168872134553063
	accu: 		92.61111111111111%
	l1: 		149.630126953125
	p dist pair: 	0.48589882254600525
	test
	time: 	1.758004903793335
	cross ent: 	0.8267338996132215
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		88.0%
	l1: 		149.630126953125
	p dist pair: 	0.48589882254600525
	above 50.00%
iteration: 	2
	train
	time: 	20.43612313270569
	cross ent: 	0.2594769494676762
	cluster: 	0.003100704668193228
	separation:	0.00907609743428313
	avg separation:	0.2116887221733729
	accu: 		93.61111111111111%
	l1: 		149.69235229492188
	p dist pair: 	0.48589882254600525
	test
	time: 	1.693608045578003
	cross ent: 	0.8342991967995962
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		90.0%
	l1: 		149.69235229492188
	p dist pair: 	0.48589882254600525
	above 50.00%
iteration: 	3
	train
	time: 	20.44379496574402
	cross ent: 	0.20879477420421608
	cluster: 	0.0031007046694867314
	separation:	0.00907609744463116
	avg separation:	0.211688721842236
	accu: 		94.44444444444444%
	l1: 		149.7388153076172
	p dist pair: 	0.48589882254600525
	test
	time: 	1.7038085460662842
	cross ent: 	0.8548715791354576
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		92.0%
	l1: 		149.7388153076172
	p dist pair: 	0.48589882254600525
	above 50.00%
iteration: 	4
	train
	time: 	20.540746212005615
	cross ent: 	0.17462123009921318
	cluster: 	0.0031007046901827887
	separation:	0.009076097382542987
	avg separation:	0.2116887215938833
	accu: 		94.66666666666667%
	l1: 		149.77920532226562
	p dist pair: 	0.48589882254600525
	test
	time: 	1.750741720199585
	cross ent: 	0.8853115206584334
	cluster: 	0.005010605013618867
	separation:	0.005902227014303207
	avg separation:	0.16685286660989126
	accu: 		92.0%
	l1: 		149.77920532226562
	p dist pair: 	0.48589882254600525
	above 50.00%
epoch: 	16
	joint
	train
	time: 	24.98157262802124
	cross ent: 	0.05074809532167516
	cluster: 	0.0031566959456540643
	separation:	0.00926053383284145
	avg separation:	0.20781432108746634
	accu: 		98.61111111111111%
	l1: 		149.77920532226562
	p dist pair: 	0.48518574237823486
	test
	time: 	1.7745544910430908
	cross ent: 	0.7180087481780598
	cluster: 	0.004822540329769254
	separation:	0.006549835205078125
	avg separation:	0.16403250396251678
	accu: 		94.0%
	l1: 		149.77920532226562
	p dist pair: 	0.48518574237823486
	above 50.00%
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	1.7030327320098877
	cross ent: 	0.7180087481780598
	cluster: 	0.004822540329769254
	separation:	0.006549835205078125
	avg separation:	0.16403250396251678
	accu: 		94.0%
	l1: 		149.77920532226562
	p dist pair: 	0.48518574237823486
	above 50.00%
Execution time (minutes): 17.013775952657063
