training set size: 9335
push set size: 9335
test set size: 12236
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	247.63577699661255
	cross ent: 	1.3992485347856036
	cluster: 	1.0369092348396651
	separation:	0.8208267637697991
	avg separation:	14.01117369960156
	accu: 		58.54311730048206%
	l1: 		360.0
	p dist pair: 	27.539270401000977
	test
	time: 	218.54061484336853
	cross ent: 	2.5214135590332005
	cluster: 	0.26331185026009096
	separation:	0.13302971569979502
	avg separation:	14.625536521275839
	accu: 		27.084014383785547%
	l1: 		360.0
	p dist pair: 	27.539270401000977
epoch: 	1
	warm
	train
	time: 	247.61951899528503
	cross ent: 	1.2401747486576022
	cluster: 	0.15660632671329652
	separation:	0.11313882874568218
	avg separation:	15.701289134056205
	accu: 		63.06373861810391%
	l1: 		360.0
	p dist pair: 	29.757984161376953
	test
	time: 	163.0590991973877
	cross ent: 	2.4380930638780782
	cluster: 	0.17901095072282294
	separation:	0.053813857062920634
	avg separation:	15.629249127082575
	accu: 		26.634521085322%
	l1: 		360.0
	p dist pair: 	29.757984161376953
epoch: 	2
	warm
	train
	time: 	70.60555458068848
	cross ent: 	1.1237102549770404
	cluster: 	0.10987243010030313
	separation:	0.08749132671211976
	avg separation:	17.0547994495204
	accu: 		66.49169791108731%
	l1: 		360.0
	p dist pair: 	32.11162567138672
	test
	time: 	105.7966799736023
	cross ent: 	2.395477940444074
	cluster: 	0.15812786707496332
	separation:	0.061167950455854145
	avg separation:	17.31116954953063
	accu: 		26.119646943445566%
	l1: 		360.0
	p dist pair: 	32.11162567138672
epoch: 	3
	warm
	train
	time: 	68.4577968120575
	cross ent: 	1.0637897454696754
	cluster: 	0.10638516918781993
	separation:	0.08644050468214064
	avg separation:	18.854946875725364
	accu: 		68.33422603106588%
	l1: 		360.0
	p dist pair: 	35.2856559753418
	test
	time: 	94.30756497383118
	cross ent: 	1.95998991139574
	cluster: 	0.14284400928010738
	separation:	0.09584034756556445
	avg separation:	19.43553587969612
	accu: 		36.106570774763%
	l1: 		360.0
	p dist pair: 	35.2856559753418
epoch: 	4
	warm
	train
	time: 	68.45933032035828
	cross ent: 	1.0139610880957937
	cluster: 	0.0974126447718072
	separation:	0.07722320882264501
	avg separation:	20.618718876317942
	accu: 		70.05891805034815%
	l1: 		360.0
	p dist pair: 	36.653892517089844
	test
	time: 	92.75934886932373
	cross ent: 	2.6218140680415956
	cluster: 	0.0811212753901392
	separation:	0.032774025826940154
	avg separation:	19.683648178000855
	accu: 		31.15397188623733%
	l1: 		360.0
	p dist pair: 	36.653892517089844
epoch: 	5
	joint
	train
	time: 	80.24917578697205
	cross ent: 	1.1162259338116494
	cluster: 	0.13980421675189658
	separation:	0.0998426816751283
	avg separation:	21.21645331535911
	accu: 		64.35993572576326%
	l1: 		360.0
	p dist pair: 	38.19443893432617
	test
	time: 	93.27389407157898
	cross ent: 	2.9482309305979535
	cluster: 	0.25477745611634517
	separation:	0.05434085823765962
	avg separation:	20.444591141993705
	accu: 		28.726708074534162%
	l1: 		360.0
	p dist pair: 	38.19443893432617
	push
	Executing push ...
	push time: 	332.59574365615845
	test
	time: 	93.49311804771423
	cross ent: 	23.54518900042266
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		20.80745341614907%
	l1: 		360.0
	p dist pair: 	0.8461962938308716
	last layer
iteration: 	0
	train
	time: 	73.39116096496582
	cross ent: 	12.160832771141983
	cluster: 	0.0017534042559005719
	separation:	6.0185086978726875e-05
	avg separation:	0.11019857706426298
	accu: 		40.0%
	l1: 		356.9952697753906
	p dist pair: 	0.8461962938308716
	test
	time: 	94.60489654541016
	cross ent: 	20.275537850810032
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		19.57338999673096%
	l1: 		356.9952697753906
	p dist pair: 	0.8461962938308716
iteration: 	1
	train
	time: 	67.98110771179199
	cross ent: 	8.70711835446654
	cluster: 	0.0017528340909065433
	separation:	6.0093327254910476e-05
	avg separation:	0.11019703859116331
	accu: 		46.60953401178361%
	l1: 		355.6256408691406
	p dist pair: 	0.8461962938308716
	test
	time: 	93.28166723251343
	cross ent: 	19.312377806582482
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		19.67146126185028%
	l1: 		355.6256408691406
	p dist pair: 	0.8461962938308716
iteration: 	2
	train
	time: 	68.25085544586182
	cross ent: 	7.107670530262034
	cluster: 	0.001753121351649211
	separation:	6.013934337012852e-05
	avg separation:	0.11020163727457569
	accu: 		49.394750937332624%
	l1: 		354.315185546875
	p dist pair: 	0.8461962938308716
	test
	time: 	94.16022157669067
	cross ent: 	19.089138403437495
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		19.77770513239621%
	l1: 		354.315185546875
	p dist pair: 	0.8461962938308716
iteration: 	3
	train
	time: 	68.10192060470581
	cross ent: 	6.398535369039858
	cluster: 	0.0017556111139534001
	separation:	6.025125184286786e-05
	avg separation:	0.11019817168567114
	accu: 		50.42313872522763%
	l1: 		353.0809631347656
	p dist pair: 	0.8461962938308716
	test
	time: 	93.39532232284546
	cross ent: 	18.79572279390946
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		20.120954560313827%
	l1: 		353.0809631347656
	p dist pair: 	0.8461962938308716
iteration: 	4
	train
	time: 	68.53034567832947
	cross ent: 	5.800493915535398
	cluster: 	0.0017532757319207353
	separation:	6.0130902469574225e-05
	avg separation:	0.11019772310328432
	accu: 		51.762185324049284%
	l1: 		352.0374450683594
	p dist pair: 	0.8461962938308716
	test
	time: 	93.60127592086792
	cross ent: 	18.183568539183124
	cluster: 	0.0014357747801779647
	separation:	1.4603683601031734e-05
	avg separation:	0.07135001493897898
	accu: 		20.53775743707094%
	l1: 		352.0374450683594
	p dist pair: 	0.8461962938308716
epoch: 	6
	joint
	train
	time: 	80.39281630516052
	cross ent: 	0.9710755011892421
	cluster: 	0.12509609734723284
	separation:	0.1139303426796714
	avg separation:	1.487369548696905
	accu: 		68.35565077664702%
	l1: 		352.0374450683594
	p dist pair: 	1.8118560314178467
	test
	time: 	93.71435880661011
	cross ent: 	2.7381749414151013
	cluster: 	0.14558973422675742
	separation:	0.05814559529444166
	avg separation:	1.1460540050190258
	accu: 		28.68584504740111%
	l1: 		352.0374450683594
	p dist pair: 	1.8118560314178467
epoch: 	7
	joint
	train
	time: 	80.18477463722229
	cross ent: 	0.6300939385015398
	cluster: 	0.0622821184158389
	separation:	0.10539579409826746
	avg separation:	1.4084738681862645
	accu: 		78.82163899303696%
	l1: 		352.0374450683594
	p dist pair: 	1.999027967453003
	test
	time: 	93.56055474281311
	cross ent: 	3.100020527450088
	cluster: 	0.107743253596614
	separation:	0.04795598125182628
	avg separation:	1.1275281053937338
	accu: 		30.557371690094804%
	l1: 		352.0374450683594
	p dist pair: 	1.999027967453003
epoch: 	8
	joint
	train
	time: 	80.2186427116394
	cross ent: 	0.4984776542723434
	cluster: 	0.05204948826595279
	separation:	0.09953962173911182
	avg separation:	1.4391076677105923
	accu: 		83.4279592929834%
	l1: 		352.0374450683594
	p dist pair: 	2.1999900341033936
	test
	time: 	92.44467759132385
	cross ent: 	2.429507971589082
	cluster: 	0.10365078285993899
	separation:	0.060182067468226734
	avg separation:	1.3145964985189875
	accu: 		39.816933638443935%
	l1: 		352.0374450683594
	p dist pair: 	2.1999900341033936
epoch: 	9
	joint
	train
	time: 	80.28183460235596
	cross ent: 	0.40545921215320874
	cluster: 	0.041283015538669116
	separation:	0.10478576442637587
	avg separation:	1.4383275238298503
	accu: 		86.42742367434386%
	l1: 		352.0374450683594
	p dist pair: 	2.2917304039001465
	test
	time: 	93.87622332572937
	cross ent: 	2.750623902659011
	cluster: 	0.1253756353984666
	separation:	0.05201479247801639
	avg separation:	1.3686236429448222
	accu: 		42.276887871853546%
	l1: 		352.0374450683594
	p dist pair: 	2.2917304039001465
epoch: 	10
	joint
	train
	time: 	80.3107738494873
	cross ent: 	0.2365284960994166
	cluster: 	0.02311540243905875
	separation:	0.11200577070900664
	avg separation:	1.3933719639094024
	accu: 		91.65506159614355%
	l1: 		352.0374450683594
	p dist pair: 	2.2485580444335938
	test
	time: 	93.53466153144836
	cross ent: 	2.88087464372317
	cluster: 	0.11090665009311017
	separation:	0.04001922834226314
	avg separation:	1.3191391428311665
	accu: 		41.61490683229814%
	l1: 		352.0374450683594
	p dist pair: 	2.2485580444335938
	push
	Executing push ...
	push time: 	316.6973581314087
	test
	time: 	93.04528403282166
	cross ent: 	35.45627513586306
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		11.948349133703823%
	l1: 		352.0374450683594
	p dist pair: 	0.9411064386367798
	last layer
iteration: 	0
	train
	time: 	68.2461748123169
	cross ent: 	15.836373026927482
	cluster: 	0.008664358538880593
	separation:	0.004547375702793756
	avg separation:	0.3092898216569194
	accu: 		31.301553294054635%
	l1: 		353.81787109375
	p dist pair: 	0.9411064386367798
	test
	time: 	93.19017171859741
	cross ent: 	21.489376890893077
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		13.909774436090224%
	l1: 		353.81787109375
	p dist pair: 	0.9411064386367798
iteration: 	1
	train
	time: 	68.48734903335571
	cross ent: 	4.404020237941814
	cluster: 	0.008666273785308322
	separation:	0.0045464739003527824
	avg separation:	0.3092568263698696
	accu: 		51.39796464916979%
	l1: 		354.4522705078125
	p dist pair: 	0.9411064386367798
	test
	time: 	94.59472036361694
	cross ent: 	17.142308990160625
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		28.277214776070615%
	l1: 		354.4522705078125
	p dist pair: 	0.9411064386367798
iteration: 	2
	train
	time: 	68.19367933273315
	cross ent: 	2.4951103004194173
	cluster: 	0.008661801512732032
	separation:	0.004547553249371559
	avg separation:	0.30926877623962384
	accu: 		68.5270487412962%
	l1: 		354.279296875
	p dist pair: 	0.9411064386367798
	test
	time: 	93.31510519981384
	cross ent: 	15.406015058748084
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		30.61457992808107%
	l1: 		354.279296875
	p dist pair: 	0.9411064386367798
iteration: 	3
	train
	time: 	68.79404783248901
	cross ent: 	2.0342097754332955
	cluster: 	0.008661579335212102
	separation:	0.004547082999899656
	avg separation:	0.3092262161301341
	accu: 		72.11569362613818%
	l1: 		354.05828857421875
	p dist pair: 	0.9411064386367798
	test
	time: 	92.82449960708618
	cross ent: 	14.184943904284559
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		31.538084341288002%
	l1: 		354.05828857421875
	p dist pair: 	0.9411064386367798
iteration: 	4
	train
	time: 	68.26773881912231
	cross ent: 	1.7542235682652645
	cluster: 	0.008666998879012813
	separation:	0.004547937424794613
	avg separation:	0.3092702746199847
	accu: 		74.23674343867167%
	l1: 		353.8694763183594
	p dist pair: 	0.9411064386367798
	test
	time: 	93.78246116638184
	cross ent: 	13.37060851910535
	cluster: 	0.06534864107037291
	separation:	0.001883610117040328
	avg separation:	0.2719946973804944
	accu: 		32.486106570774766%
	l1: 		353.8694763183594
	p dist pair: 	0.9411064386367798
epoch: 	11
	joint
	train
	time: 	80.49888968467712
	cross ent: 	0.2839736751198711
	cluster: 	0.014531882519672207
	separation:	0.012858870669569205
	avg separation:	0.32506730166569003
	accu: 		92.13711837171934%
	l1: 		353.8694763183594
	p dist pair: 	1.039772629737854
	test
	time: 	94.73006653785706
	cross ent: 	5.1760544691210475
	cluster: 	0.06250234354543042
	separation:	0.010014070270984781
	avg separation:	0.27899329271776224
	accu: 		38.46028113762667%
	l1: 		353.8694763183594
	p dist pair: 	1.039772629737854
epoch: 	12
	joint
	train
	time: 	80.33558320999146
	cross ent: 	0.16266561966442142
	cluster: 	0.012526484741779479
	separation:	0.014032634216454478
	avg separation:	0.3321400037797156
	accu: 		94.60096411355116%
	l1: 		353.8694763183594
	p dist pair: 	1.0520427227020264
	test
	time: 	94.13222122192383
	cross ent: 	5.355550965257719
	cluster: 	0.05973883285765457
	separation:	0.01021607703182335
	avg separation:	0.28366409492940686
	accu: 		38.50931677018634%
	l1: 		353.8694763183594
	p dist pair: 	1.0520427227020264
epoch: 	13
	joint
	train
	time: 	80.5284698009491
	cross ent: 	0.13413386741589267
	cluster: 	0.010240639687059109
	separation:	0.013120054859644086
	avg separation:	0.32902152657636485
	accu: 		95.30798071772898%
	l1: 		353.8694763183594
	p dist pair: 	1.0629140138626099
	test
	time: 	94.0261640548706
	cross ent: 	5.163760666558945
	cluster: 	0.052984141925763756
	separation:	0.008190702603600336
	avg separation:	0.2702408944518348
	accu: 		38.901601830663616%
	l1: 		353.8694763183594
	p dist pair: 	1.0629140138626099
epoch: 	14
	joint
	train
	time: 	80.57660603523254
	cross ent: 	0.12205292334865726
	cluster: 	0.008458679086255505
	separation:	0.011484610850123063
	avg separation:	0.32026899393799474
	accu: 		95.87573647562935%
	l1: 		353.8694763183594
	p dist pair: 	1.062635064125061
	test
	time: 	93.18069124221802
	cross ent: 	5.049388293152541
	cluster: 	0.05073180525514961
	separation:	0.00744580236732278
	avg separation:	0.2704121097922325
	accu: 		40.380843412880026%
	l1: 		353.8694763183594
	p dist pair: 	1.062635064125061
epoch: 	15
	joint
	train
	time: 	80.59108066558838
	cross ent: 	0.09069472225121177
	cluster: 	0.007474449892454567
	separation:	0.010926689153908088
	avg separation:	0.31999008884011293
	accu: 		97.08623460096412%
	l1: 		353.8694763183594
	p dist pair: 	1.0648789405822754
	test
	time: 	94.07519054412842
	cross ent: 	5.04993832578846
	cluster: 	0.05129637388707278
	separation:	0.0069030575922939905
	avg separation:	0.27483635743946033
	accu: 		40.85485452762341%
	l1: 		353.8694763183594
	p dist pair: 	1.0648789405822754
	push
	Executing push ...
	push time: 	289.17880511283875
	test
	time: 	94.03889966011047
	cross ent: 	13.537488140311895
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		32.682249101013404%
	l1: 		353.8694763183594
	p dist pair: 	0.9253635406494141
	last layer
iteration: 	0
	train
	time: 	68.49939918518066
	cross ent: 	0.5272681827741245
	cluster: 	0.004014640567588422
	separation:	0.0033495223580418867
	avg separation:	0.25586506497808903
	accu: 		90.16604177825388%
	l1: 		354.0535888671875
	p dist pair: 	0.9253635406494141
	test
	time: 	94.65348696708679
	cross ent: 	12.548824535475838
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		33.671134357633214%
	l1: 		354.0535888671875
	p dist pair: 	0.9253635406494141
iteration: 	1
	train
	time: 	68.49590635299683
	cross ent: 	0.4530960733947481
	cluster: 	0.004009497403733062
	separation:	0.003350026081842161
	avg separation:	0.25585842694153876
	accu: 		91.01231922870916%
	l1: 		354.1890563964844
	p dist pair: 	0.9253635406494141
	test
	time: 	93.94117140769958
	cross ent: 	11.904783523160647
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		34.390323635174894%
	l1: 		354.1890563964844
	p dist pair: 	0.9253635406494141
iteration: 	2
	train
	time: 	68.67041277885437
	cross ent: 	0.4092668659236094
	cluster: 	0.004009919720941185
	separation:	0.003350359350552571
	avg separation:	0.2558876531601463
	accu: 		91.62292447777183%
	l1: 		354.2229919433594
	p dist pair: 	0.9253635406494141
	test
	time: 	93.53515148162842
	cross ent: 	11.615095126083474
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		34.90519777705132%
	l1: 		354.2229919433594
	p dist pair: 	0.9253635406494141
iteration: 	3
	train
	time: 	68.45556259155273
	cross ent: 	0.3771025082663733
	cluster: 	0.0040109473055879715
	separation:	0.0033530517008813192
	avg separation:	0.2559178206088456
	accu: 		92.11569362613818%
	l1: 		354.2296142578125
	p dist pair: 	0.9253635406494141
	test
	time: 	94.31817817687988
	cross ent: 	11.468650306751526
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		35.191238966982674%
	l1: 		354.2296142578125
	p dist pair: 	0.9253635406494141
iteration: 	4
	train
	time: 	68.7416365146637
	cross ent: 	0.3498841093928789
	cluster: 	0.00401533489555272
	separation:	0.003350101780406612
	avg separation:	0.2558542447248414
	accu: 		92.3942153186931%
	l1: 		354.2025146484375
	p dist pair: 	0.9253635406494141
	test
	time: 	93.52468252182007
	cross ent: 	11.310455362391627
	cluster: 	0.03647032642609203
	separation:	0.0017508740795069957
	avg separation:	0.1960647785488297
	accu: 		35.53448839490029%
	l1: 		354.2025146484375
	p dist pair: 	0.9253635406494141
epoch: 	16
	joint
	train
	time: 	80.64374375343323
	cross ent: 	0.1346267833063709
	cluster: 	0.0057864155509654725
	separation:	0.005113233382513496
	avg separation:	0.25761572187028553
	accu: 		96.03642206748795%
	l1: 		354.2025146484375
	p dist pair: 	0.9308210611343384
	test
	time: 	95.85833311080933
	cross ent: 	8.51601396432889
	cluster: 	0.032998212944911
	separation:	0.0026836079361565483
	avg separation:	0.19411485634890258
	accu: 		41.43510951291272%
	l1: 		354.2025146484375
	p dist pair: 	0.9308210611343384
epoch: 	17
	joint
	train
	time: 	80.32834696769714
	cross ent: 	0.09554960930356517
	cluster: 	0.005619308653878889
	separation:	0.005221799232626067
	avg separation:	0.2512679601953678
	accu: 		97.02196036422067%
	l1: 		354.2025146484375
	p dist pair: 	0.9345463514328003
	test
	time: 	95.14159893989563
	cross ent: 	8.286289772177055
	cluster: 	0.035359393370039516
	separation:	0.0030799683984642956
	avg separation:	0.19832751814738597
	accu: 		40.66688460281138%
	l1: 		354.2025146484375
	p dist pair: 	0.9345463514328003
epoch: 	18
	joint
	train
	time: 	80.51695203781128
	cross ent: 	0.08514948057552836
	cluster: 	0.005539666975218189
	separation:	0.005558164045912646
	avg separation:	0.2522304306959442
	accu: 		97.40760578468131%
	l1: 		354.2025146484375
	p dist pair: 	0.9367015957832336
	test
	time: 	93.85104537010193
	cross ent: 	8.219628843606687
	cluster: 	0.03542721136381813
	separation:	0.003252904456994478
	avg separation:	0.19812800555057775
	accu: 		40.75678326250409%
	l1: 		354.2025146484375
	p dist pair: 	0.9367015957832336
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	94.56367325782776
	cross ent: 	8.219628843606687
	cluster: 	0.03542721136381813
	separation:	0.003252904456994478
	avg separation:	0.19812800555057775
	accu: 		40.75678326250409%
	l1: 		354.2025146484375
	p dist pair: 	0.9367015957832336
Execution time (minutes): 126.22915928761164
