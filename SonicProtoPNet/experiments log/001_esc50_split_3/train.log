training set size: 1080
push set size: 90
test set size: 30
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	49.81430435180664
	cross ent: 	0.9215190830054106
	cluster: 	2.851695070664088
	separation:	3.1833146004765123
	avg separation:	11.681316234447339
	accu: 		63.24074074074074%
	l1: 		60.0
	p dist pair: 	19.118946075439453
	test
	time: 	2.421962022781372
	cross ent: 	0.7690736055374146
	cluster: 	0.7721346020698547
	separation:	1.2970399856567383
	avg separation:	11.381479740142822
	accu: 		73.33333333333333%
	l1: 		60.0
	p dist pair: 	19.118946075439453
	above 50.00%
epoch: 	1
	warm
	train
	time: 	12.517303943634033
	cross ent: 	0.5616120740219399
	cluster: 	0.3703897606443476
	separation:	0.9918196234438155
	avg separation:	10.989467868098506
	accu: 		81.57407407407408%
	l1: 		60.0
	p dist pair: 	18.93758201599121
	test
	time: 	1.5746943950653076
	cross ent: 	0.6492061913013458
	cluster: 	0.3896429091691971
	separation:	1.176125943660736
	avg separation:	10.990982055664062
	accu: 		76.66666666666667%
	l1: 		60.0
	p dist pair: 	18.93758201599121
	above 50.00%
epoch: 	2
	warm
	train
	time: 	12.25961971282959
	cross ent: 	0.372448123715542
	cluster: 	0.2025920409295294
	separation:	1.0127306602619313
	avg separation:	10.540854930877686
	accu: 		90.55555555555556%
	l1: 		60.0
	p dist pair: 	18.554649353027344
	test
	time: 	1.5722782611846924
	cross ent: 	0.6739093661308289
	cluster: 	0.30329228937625885
	separation:	1.0441316962242126
	avg separation:	10.62319040298462
	accu: 		73.33333333333333%
	l1: 		60.0
	p dist pair: 	18.554649353027344
	above 50.00%
epoch: 	3
	warm
	train
	time: 	12.760305166244507
	cross ent: 	0.26862294337263815
	cluster: 	0.15383115976496978
	separation:	1.070750477137389
	avg separation:	10.14982937000416
	accu: 		93.42592592592592%
	l1: 		60.0
	p dist pair: 	18.363502502441406
	test
	time: 	1.5686917304992676
	cross ent: 	0.578715980052948
	cluster: 	0.2627525329589844
	separation:	1.2342045307159424
	avg separation:	10.408546924591064
	accu: 		86.66666666666667%
	l1: 		60.0
	p dist pair: 	18.363502502441406
	above 50.00%
epoch: 	4
	warm
	train
	time: 	12.599730730056763
	cross ent: 	0.2057342961154602
	cluster: 	0.1189916841685772
	separation:	1.1665340297751956
	avg separation:	10.051389941462764
	accu: 		95.37037037037037%
	l1: 		60.0
	p dist pair: 	18.237733840942383
	test
	time: 	1.5594067573547363
	cross ent: 	0.653438925743103
	cluster: 	0.26213227212429047
	separation:	1.306430995464325
	avg separation:	10.190526008605957
	accu: 		76.66666666666667%
	l1: 		60.0
	p dist pair: 	18.237733840942383
	above 50.00%
epoch: 	5
	joint
	train
	time: 	15.422716856002808
	cross ent: 	0.8666450520632444
	cluster: 	0.5983913756079144
	separation:	0.772460686939734
	avg separation:	10.301145906801578
	accu: 		58.79629629629629%
	l1: 		60.0
	p dist pair: 	17.576560974121094
	test
	time: 	1.557863473892212
	cross ent: 	0.680950403213501
	cluster: 	0.411570742726326
	separation:	0.41772519052028656
	avg separation:	10.53299856185913
	accu: 		66.66666666666666%
	l1: 		60.0
	p dist pair: 	17.576560974121094
	above 50.00%
	push
	Executing push ...
	push time: 	42.066142320632935
	test
	time: 	1.4734318256378174
	cross ent: 	0.8035379946231842
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		70.0%
	l1: 		60.0
	p dist pair: 	1.6554758548736572
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	12.490114212036133
	cross ent: 	2.0347216250719846
	cluster: 	0.18986461449552466
	separation:	0.20865562227037218
	avg separation:	1.2789273924297757
	accu: 		51.01851851851852%
	l1: 		59.9572639465332
	p dist pair: 	1.6554758548736572
	test
	time: 	1.518204927444458
	cross ent: 	0.7559820711612701
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		70.0%
	l1: 		59.9572639465332
	p dist pair: 	1.6554758548736572
	above 50.00%
iteration: 	1
	train
	time: 	12.571824789047241
	cross ent: 	1.9479788144429524
	cluster: 	0.1898646131157875
	separation:	0.2086556224083459
	avg separation:	1.2789273725615606
	accu: 		52.5%
	l1: 		59.913516998291016
	p dist pair: 	1.6554758548736572
	test
	time: 	1.528646469116211
	cross ent: 	0.7166279256343842
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		80.0%
	l1: 		59.913516998291016
	p dist pair: 	1.6554758548736572
	above 50.00%
iteration: 	2
	train
	time: 	12.662079572677612
	cross ent: 	1.8699733350012038
	cluster: 	0.18986461421957723
	separation:	0.20865562227037218
	avg separation:	1.278927383599458
	accu: 		53.7962962962963%
	l1: 		59.869354248046875
	p dist pair: 	1.6554758548736572
	test
	time: 	1.5114259719848633
	cross ent: 	0.6862174570560455
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		76.66666666666667%
	l1: 		59.869354248046875
	p dist pair: 	1.6554758548736572
	above 50.00%
iteration: 	3
	train
	time: 	12.670568227767944
	cross ent: 	1.8016447756025527
	cluster: 	0.18986461380565609
	separation:	0.20865562199442475
	avg separation:	1.278927379184299
	accu: 		55.74074074074075%
	l1: 		59.825321197509766
	p dist pair: 	1.6554758548736572
	test
	time: 	1.4832067489624023
	cross ent: 	0.6636021435260773
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		76.66666666666667%
	l1: 		59.825321197509766
	p dist pair: 	1.6554758548736572
	above 50.00%
iteration: 	4
	train
	time: 	12.682252645492554
	cross ent: 	1.7411262856589422
	cluster: 	0.18986461408160352
	separation:	0.2086556225463196
	avg separation:	1.278927399052514
	accu: 		58.14814814814815%
	l1: 		59.783714294433594
	p dist pair: 	1.6554758548736572
	test
	time: 	1.54119873046875
	cross ent: 	0.648971676826477
	cluster: 	0.1630168966948986
	separation:	0.18945427238941193
	avg separation:	1.2948885560035706
	accu: 		73.33333333333333%
	l1: 		59.783714294433594
	p dist pair: 	1.6554758548736572
	above 50.00%
epoch: 	6
	joint
	train
	time: 	15.40904688835144
	cross ent: 	0.6707003591237245
	cluster: 	0.2739832041164239
	separation:	0.5674889846532433
	avg separation:	1.8934574292765722
	accu: 		73.51851851851852%
	l1: 		59.783714294433594
	p dist pair: 	1.7994356155395508
	test
	time: 	1.5099754333496094
	cross ent: 	0.7971177399158478
	cluster: 	0.1658361479640007
	separation:	0.6553648114204407
	avg separation:	1.9186021089553833
	accu: 		73.33333333333333%
	l1: 		59.783714294433594
	p dist pair: 	1.7994356155395508
	above 50.00%
epoch: 	7
	joint
	train
	time: 	15.539891481399536
	cross ent: 	0.42816488272338
	cluster: 	0.162998766672832
	separation:	0.5515058934688568
	avg separation:	1.858130106219539
	accu: 		85.37037037037038%
	l1: 		59.783714294433594
	p dist pair: 	2.0100314617156982
	test
	time: 	1.5060927867889404
	cross ent: 	0.17434635385870934
	cluster: 	0.06382274627685547
	separation:	0.47838403284549713
	avg separation:	1.8768001794815063
	accu: 		96.66666666666667%
	l1: 		59.783714294433594
	p dist pair: 	2.0100314617156982
	above 50.00%
epoch: 	8
	joint
	train
	time: 	15.508634328842163
	cross ent: 	0.18219291918945532
	cluster: 	0.08625766076147556
	separation:	0.8750382479694154
	avg separation:	2.3017717003822327
	accu: 		94.44444444444444%
	l1: 		59.783714294433594
	p dist pair: 	2.0499026775360107
	test
	time: 	1.4723026752471924
	cross ent: 	0.36438724398612976
	cluster: 	0.1542162001132965
	separation:	1.3977493643760681
	avg separation:	2.9149986505508423
	accu: 		86.66666666666667%
	l1: 		59.783714294433594
	p dist pair: 	2.0499026775360107
	above 50.00%
epoch: 	9
	joint
	train
	time: 	15.60897970199585
	cross ent: 	0.1325565082003811
	cluster: 	0.08732318346975027
	separation:	1.2534442019683343
	avg separation:	2.571690513028039
	accu: 		96.85185185185186%
	l1: 		59.783714294433594
	p dist pair: 	2.12015438079834
	test
	time: 	1.5436770915985107
	cross ent: 	0.4115353524684906
	cluster: 	0.1496877744793892
	separation:	2.2499340176582336
	avg separation:	3.6280646324157715
	accu: 		80.0%
	l1: 		59.783714294433594
	p dist pair: 	2.12015438079834
	above 50.00%
epoch: 	10
	joint
	train
	time: 	15.510997533798218
	cross ent: 	0.08934657200222353
	cluster: 	0.060743615238202944
	separation:	1.626590993669298
	avg separation:	2.819181212672481
	accu: 		97.5925925925926%
	l1: 		59.783714294433594
	p dist pair: 	2.1304092407226562
	test
	time: 	1.512420654296875
	cross ent: 	0.5485217273235321
	cluster: 	0.08132496103644371
	separation:	1.796512246131897
	avg separation:	3.0150266885757446
	accu: 		83.33333333333334%
	l1: 		59.783714294433594
	p dist pair: 	2.1304092407226562
	above 50.00%
	push
	Executing push ...
	push time: 	36.920265436172485
	test
	time: 	1.5064401626586914
	cross ent: 	4.913240194320679
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.783714294433594
	p dist pair: 	1.4605239629745483
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	12.242424011230469
	cross ent: 	0.7476256404214736
	cluster: 	0.021028532991530718
	separation:	1.1802934043937259
	avg separation:	1.9828586512141757
	accu: 		92.31481481481481%
	l1: 		59.74941635131836
	p dist pair: 	1.4605239629745483
	test
	time: 	1.5236997604370117
	cross ent: 	4.839663982391357
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.74941635131836
	p dist pair: 	1.4605239629745483
	above 50.00%
iteration: 	1
	train
	time: 	12.59725570678711
	cross ent: 	0.7128917186053985
	cluster: 	0.021028533163997862
	separation:	1.1802934038418311
	avg separation:	1.9828586379686992
	accu: 		92.5%
	l1: 		59.73609924316406
	p dist pair: 	1.4605239629745483
	test
	time: 	1.5040087699890137
	cross ent: 	4.746147632598877
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.73609924316406
	p dist pair: 	1.4605239629745483
	above 50.00%
iteration: 	2
	train
	time: 	12.735065221786499
	cross ent: 	0.6806175833601932
	cluster: 	0.021028533250231435
	separation:	1.180293394183671
	avg separation:	1.982858626930802
	accu: 		92.5%
	l1: 		59.72752380371094
	p dist pair: 	1.4605239629745483
	test
	time: 	1.5328338146209717
	cross ent: 	4.661407709121704
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.72752380371094
	p dist pair: 	1.4605239629745483
	above 50.00%
iteration: 	3
	train
	time: 	12.639212369918823
	cross ent: 	0.6516904232813869
	cluster: 	0.021028533146751148
	separation:	1.180293400530462
	avg separation:	1.9828586379686992
	accu: 		92.77777777777779%
	l1: 		59.719947814941406
	p dist pair: 	1.4605239629745483
	test
	time: 	1.525071620941162
	cross ent: 	4.577319383621216
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.719947814941406
	p dist pair: 	1.4605239629745483
	above 50.00%
iteration: 	4
	train
	time: 	12.896602630615234
	cross ent: 	0.624881909659625
	cluster: 	0.021028533163997862
	separation:	1.1802934019101992
	avg separation:	1.9828586401762787
	accu: 		92.87037037037037%
	l1: 		59.71257781982422
	p dist pair: 	1.4605239629745483
	test
	time: 	1.5286757946014404
	cross ent: 	4.49641752243042
	cluster: 	0.06463489681482315
	separation:	1.5135696530342102
	avg separation:	2.3966017961502075
	accu: 		70.0%
	l1: 		59.71257781982422
	p dist pair: 	1.4605239629745483
	above 50.00%
epoch: 	11
	joint
	train
	time: 	15.529350280761719
	cross ent: 	0.5471480424856525
	cluster: 	0.10710983409511822
	separation:	1.5909382424972676
	avg separation:	2.4770046925103224
	accu: 		93.33333333333333%
	l1: 		59.71257781982422
	p dist pair: 	1.5015047788619995
	test
	time: 	1.5313999652862549
	cross ent: 	0.6713813971728086
	cluster: 	0.06178741343319416
	separation:	1.060005396604538
	avg separation:	1.8464511036872864
	accu: 		86.66666666666667%
	l1: 		59.71257781982422
	p dist pair: 	1.5015047788619995
	above 50.00%
epoch: 	12
	joint
	train
	time: 	15.579540967941284
	cross ent: 	0.10822176080761926
	cluster: 	0.05058414440740038
	separation:	1.5357592321104474
	avg separation:	2.3820879249661058
	accu: 		97.31481481481481%
	l1: 		59.71257781982422
	p dist pair: 	1.5185028314590454
	test
	time: 	1.5420770645141602
	cross ent: 	1.3818532824516296
	cluster: 	0.13445892557501793
	separation:	1.9817407727241516
	avg separation:	2.9823354482650757
	accu: 		80.0%
	l1: 		59.71257781982422
	p dist pair: 	1.5185028314590454
	above 50.00%
epoch: 	13
	joint
	train
	time: 	15.630471229553223
	cross ent: 	0.08894106166688423
	cluster: 	0.033343661697236474
	separation:	1.3741055020579585
	avg separation:	2.1894157837938377
	accu: 		98.05555555555556%
	l1: 		59.71257781982422
	p dist pair: 	1.5095133781433105
	test
	time: 	1.5445528030395508
	cross ent: 	1.820261001586914
	cluster: 	0.07817821763455868
	separation:	1.7449918985366821
	avg separation:	2.6613587141036987
	accu: 		80.0%
	l1: 		59.71257781982422
	p dist pair: 	1.5095133781433105
	above 50.00%
epoch: 	14
	joint
	train
	time: 	15.615913391113281
	cross ent: 	0.058535871756181156
	cluster: 	0.04572253129272549
	separation:	1.8203021895002436
	avg separation:	2.6889948822833873
	accu: 		98.24074074074073%
	l1: 		59.71257781982422
	p dist pair: 	1.526817798614502
	test
	time: 	1.5054693222045898
	cross ent: 	1.6734235286712646
	cluster: 	0.11641807854175568
	separation:	1.882807731628418
	avg separation:	2.8777884244918823
	accu: 		80.0%
	l1: 		59.71257781982422
	p dist pair: 	1.526817798614502
	above 50.00%
epoch: 	15
	joint
	train
	time: 	15.78014874458313
	cross ent: 	0.056125673077379666
	cluster: 	0.03585228451562149
	separation:	1.9166548826076366
	avg separation:	2.812550416699162
	accu: 		98.33333333333333%
	l1: 		59.71257781982422
	p dist pair: 	1.53016996383667
	test
	time: 	1.5254900455474854
	cross ent: 	1.4305826425552368
	cluster: 	0.10214881971478462
	separation:	1.7909084558486938
	avg separation:	2.757477283477783
	accu: 		80.0%
	l1: 		59.71257781982422
	p dist pair: 	1.53016996383667
	above 50.00%
	push
	Executing push ...
	push time: 	37.261061668395996
	test
	time: 	1.4705398082733154
	cross ent: 	3.026056170463562
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.71257781982422
	p dist pair: 	1.4972513914108276
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	12.386137962341309
	cross ent: 	0.366550589437355
	cluster: 	0.026816594604126835
	separation:	1.7858682870864868
	avg separation:	2.665434382579945
	accu: 		91.75925925925927%
	l1: 		59.71725845336914
	p dist pair: 	1.4972513914108276
	test
	time: 	1.4558603763580322
	cross ent: 	2.94840407371521
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.71725845336914
	p dist pair: 	1.4972513914108276
	above 50.00%
iteration: 	1
	train
	time: 	12.552810430526733
	cross ent: 	0.3267322611904496
	cluster: 	0.026816594690360403
	separation:	1.7858682926054354
	avg separation:	2.6654344068633185
	accu: 		92.12962962962963%
	l1: 		59.72379684448242
	p dist pair: 	1.4972513914108276
	test
	time: 	1.4437403678894043
	cross ent: 	2.870131254196167
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.72379684448242
	p dist pair: 	1.4972513914108276
	above 50.00%
iteration: 	2
	train
	time: 	12.703454971313477
	cross ent: 	0.2917339297289598
	cluster: 	0.026816594448906404
	separation:	1.785868282671328
	avg separation:	2.6654343362207764
	accu: 		92.5925925925926%
	l1: 		59.72840881347656
	p dist pair: 	1.4972513914108276
	test
	time: 	1.8310704231262207
	cross ent: 	2.8003774881362915
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.72840881347656
	p dist pair: 	1.4972513914108276
	above 50.00%
iteration: 	3
	train
	time: 	12.631600379943848
	cross ent: 	0.2610315842558285
	cluster: 	0.026816594483399833
	separation:	1.7858682887421713
	avg separation:	2.6654343847875244
	accu: 		93.14814814814815%
	l1: 		59.73229217529297
	p dist pair: 	1.4972513914108276
	test
	time: 	1.460315465927124
	cross ent: 	2.7366961240768433
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.73229217529297
	p dist pair: 	1.4972513914108276
	above 50.00%
iteration: 	4
	train
	time: 	12.612777471542358
	cross ent: 	0.23460149014566992
	cluster: 	0.026816594535139977
	separation:	1.785868285982697
	avg separation:	2.6654343759572066
	accu: 		93.51851851851852%
	l1: 		59.735008239746094
	p dist pair: 	1.4972513914108276
	test
	time: 	1.4480164051055908
	cross ent: 	2.6765613555908203
	cluster: 	0.08831577375531197
	separation:	1.7194604873657227
	avg separation:	2.6486120223999023
	accu: 		73.33333333333333%
	l1: 		59.735008239746094
	p dist pair: 	1.4972513914108276
	above 50.00%
epoch: 	16
	joint
	train
	time: 	15.546286582946777
	cross ent: 	0.13765657646365947
	cluster: 	0.025712388119211903
	separation:	1.7585473711843844
	avg separation:	2.6303630846518056
	accu: 		96.11111111111111%
	l1: 		59.735008239746094
	p dist pair: 	1.50007963180542
	test
	time: 	1.4818437099456787
	cross ent: 	2.1717478036880493
	cluster: 	0.07023811340332031
	separation:	1.6835039258003235
	avg separation:	2.5927233695983887
	accu: 		80.0%
	l1: 		59.735008239746094
	p dist pair: 	1.50007963180542
	above 50.00%
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	1.4572393894195557
	cross ent: 	2.1717478036880493
	cluster: 	0.07023811340332031
	separation:	1.6835039258003235
	avg separation:	2.5927233695983887
	accu: 		80.0%
	l1: 		59.735008239746094
	p dist pair: 	1.50007963180542
	above 50.00%
Execution time (minutes): 10.978027296066283
