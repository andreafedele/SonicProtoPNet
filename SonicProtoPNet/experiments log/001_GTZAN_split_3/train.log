training set size: 3375
push set size: 1125
test set size: 375
batch size: 20
start training
epoch: 	0
	warm
	train
	time: 	82.68590116500854
	cross ent: 	0.9953911367958114
	cluster: 	1.3301464366842304
	separation:	1.2881220364006314
	avg separation:	11.930336765989043
	accu: 		50.01481481481481%
	l1: 		60.0
	p dist pair: 	20.24460792541504
	test
	time: 	12.390202045440674
	cross ent: 	0.9220532053395322
	cluster: 	0.42193588143900823
	separation:	0.4808577957906221
	avg separation:	12.080377327768426
	accu: 		57.86666666666667%
	l1: 		60.0
	p dist pair: 	20.24460792541504
	above 50.00%
epoch: 	1
	warm
	train
	time: 	49.174347162246704
	cross ent: 	0.8844478303158777
	cluster: 	0.26691265157341254
	separation:	0.31853694614221356
	avg separation:	11.155707432673527
	accu: 		59.28888888888889%
	l1: 		60.0
	p dist pair: 	20.311614990234375
	test
	time: 	6.321854114532471
	cross ent: 	0.8946200483723691
	cluster: 	0.26618364610170064
	separation:	0.31991225481033325
	avg separation:	11.294279349477668
	accu: 		57.86666666666667%
	l1: 		60.0
	p dist pair: 	20.311614990234375
	above 50.00%
epoch: 	2
	warm
	train
	time: 	48.7650682926178
	cross ent: 	0.8067032308620814
	cluster: 	0.2143788912592555
	separation:	0.2781335517499574
	avg separation:	10.823164691586467
	accu: 		63.70370370370371%
	l1: 		60.0
	p dist pair: 	19.923160552978516
	test
	time: 	6.293107271194458
	cross ent: 	0.779850506468823
	cluster: 	0.21640292672734512
	separation:	0.2889092415571213
	avg separation:	10.669270314668355
	accu: 		65.60000000000001%
	l1: 		60.0
	p dist pair: 	19.923160552978516
	above 50.00%
epoch: 	3
	warm
	train
	time: 	49.02951002120972
	cross ent: 	0.7376207005695479
	cluster: 	0.17738958452580242
	separation:	0.2546304683889863
	avg separation:	10.45916705159746
	accu: 		68.17777777777778%
	l1: 		60.0
	p dist pair: 	19.387399673461914
	test
	time: 	6.402292728424072
	cross ent: 	0.7129642932038558
	cluster: 	0.19876904236642937
	separation:	0.2877504370714489
	avg separation:	10.377612816660028
	accu: 		70.39999999999999%
	l1: 		60.0
	p dist pair: 	19.387399673461914
	above 50.00%
epoch: 	4
	warm
	train
	time: 	48.81013035774231
	cross ent: 	0.701406064294499
	cluster: 	0.16317188285687972
	separation:	0.23686432247683847
	avg separation:	9.91332503888734
	accu: 		69.42222222222222%
	l1: 		60.0
	p dist pair: 	18.963171005249023
	test
	time: 	6.221762657165527
	cross ent: 	0.8454459309577942
	cluster: 	0.17140531971266396
	separation:	0.2333889603614807
	avg separation:	9.351088975605212
	accu: 		62.4%
	l1: 		60.0
	p dist pair: 	18.963171005249023
	above 50.00%
epoch: 	5
	joint
	train
	time: 	59.66895270347595
	cross ent: 	1.0011649279904788
	cluster: 	0.3888817518596818
	separation:	0.3254782181872419
	avg separation:	9.227071542006273
	accu: 		49.57037037037037%
	l1: 		60.0
	p dist pair: 	19.192350387573242
	test
	time: 	6.240309715270996
	cross ent: 	0.6685432101550856
	cluster: 	0.1314606415598016
	separation:	0.17958742380142212
	avg separation:	8.883989534879985
	accu: 		69.6%
	l1: 		60.0
	p dist pair: 	19.192350387573242
	above 50.00%
	push
	Executing push ...
	push time: 	92.79203724861145
	test
	time: 	6.392995834350586
	cross ent: 	5.949275355590017
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		39.46666666666667%
	l1: 		60.0
	p dist pair: 	2.481348752975464
	last layer
iteration: 	0
	train
	time: 	49.69957089424133
	cross ent: 	6.765788397140051
	cluster: 	0.022453627521557922
	separation:	0.02391359418321996
	avg separation:	0.3736540504108519
	accu: 		35.55555555555556%
	l1: 		59.84925842285156
	p dist pair: 	2.481348752975464
	test
	time: 	6.561538457870483
	cross ent: 	4.862917272668136
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		43.46666666666666%
	l1: 		59.84925842285156
	p dist pair: 	2.481348752975464
iteration: 	1
	train
	time: 	49.58069372177124
	cross ent: 	5.591975857520245
	cluster: 	0.022463253054481287
	separation:	0.02391607630667249
	avg separation:	0.37368627236439633
	accu: 		37.15555555555555%
	l1: 		59.710208892822266
	p dist pair: 	2.481348752975464
	test
	time: 	6.670573472976685
	cross ent: 	4.021192701239335
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		49.06666666666666%
	l1: 		59.710208892822266
	p dist pair: 	2.481348752975464
iteration: 	2
	train
	time: 	49.142571687698364
	cross ent: 	4.639475336441627
	cluster: 	0.022449851912286507
	separation:	0.023907268695401017
	avg separation:	0.37378723769498295
	accu: 		40.41481481481482%
	l1: 		59.59321212768555
	p dist pair: 	2.481348752975464
	test
	time: 	6.66057825088501
	cross ent: 	3.430694573803952
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		50.66666666666667%
	l1: 		59.59321212768555
	p dist pair: 	2.481348752975464
	above 50.00%
iteration: 	3
	train
	time: 	49.69128632545471
	cross ent: 	3.9242993600269744
	cluster: 	0.022454500242450534
	separation:	0.0239144428440276
	avg separation:	0.37367183975214086
	accu: 		42.37037037037037%
	l1: 		59.50547790527344
	p dist pair: 	2.481348752975464
	test
	time: 	6.527992486953735
	cross ent: 	3.0286237252385995
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		53.6%
	l1: 		59.50547790527344
	p dist pair: 	2.481348752975464
	above 50.00%
iteration: 	4
	train
	time: 	49.37901949882507
	cross ent: 	3.380220391341215
	cluster: 	0.022451231884356788
	separation:	0.023918947568659248
	avg separation:	0.37385273420599086
	accu: 		45.096296296296295%
	l1: 		59.44261169433594
	p dist pair: 	2.481348752975464
	test
	time: 	6.552484512329102
	cross ent: 	2.739898725559837
	cluster: 	0.02258152926438733
	separation:	0.024753611044664132
	avg separation:	0.36957087955976786
	accu: 		55.2%
	l1: 		59.44261169433594
	p dist pair: 	2.481348752975464
	above 50.00%
epoch: 	6
	joint
	train
	time: 	59.82902717590332
	cross ent: 	1.1523187622516113
	cluster: 	0.21161343288448084
	separation:	0.1785032107610498
	avg separation:	1.567872469329975
	accu: 		48.71111111111111%
	l1: 		59.44261169433594
	p dist pair: 	3.0694713592529297
	test
	time: 	6.106062173843384
	cross ent: 	0.6816113732363048
	cluster: 	0.03734019183014568
	separation:	0.03725128248333931
	avg separation:	1.3677175358722085
	accu: 		69.06666666666666%
	l1: 		59.44261169433594
	p dist pair: 	3.0694713592529297
	above 50.00%
epoch: 	7
	joint
	train
	time: 	60.187819719314575
	cross ent: 	0.6161106689089149
	cluster: 	0.06697974381582623
	separation:	0.060736486743364106
	avg separation:	1.3396570255770486
	accu: 		74.3111111111111%
	l1: 		59.44261169433594
	p dist pair: 	3.348064661026001
	test
	time: 	6.412083625793457
	cross ent: 	0.4142763093113899
	cluster: 	0.046088162613542455
	separation:	0.040927667170763016
	avg separation:	1.231622721019544
	accu: 		84.0%
	l1: 		59.44261169433594
	p dist pair: 	3.348064661026001
	above 50.00%
epoch: 	8
	joint
	train
	time: 	60.27212405204773
	cross ent: 	0.34378395809312545
	cluster: 	0.04216044198875949
	separation:	0.0394031290383734
	avg separation:	1.5168933819031574
	accu: 		88.14814814814815%
	l1: 		59.44261169433594
	p dist pair: 	3.5421149730682373
	test
	time: 	6.759226560592651
	cross ent: 	0.35435761628966583
	cluster: 	0.032517350033709876
	separation:	0.027750189759229358
	avg separation:	1.4774687478416844
	accu: 		88.53333333333333%
	l1: 		59.44261169433594
	p dist pair: 	3.5421149730682373
	above 50.00%
epoch: 	9
	joint
	train
	time: 	60.357879877090454
	cross ent: 	0.21606994761407552
	cluster: 	0.02570152785298387
	separation:	0.022214773254325755
	avg separation:	1.5949647638219349
	accu: 		93.39259259259259%
	l1: 		59.44261169433594
	p dist pair: 	3.597365617752075
	test
	time: 	6.788700342178345
	cross ent: 	0.28997249273877396
	cluster: 	0.01917624914724576
	separation:	0.0176249056270248
	avg separation:	1.5344046103326898
	accu: 		91.2%
	l1: 		59.44261169433594
	p dist pair: 	3.597365617752075
	above 50.00%
epoch: 	10
	joint
	train
	time: 	60.379247188568115
	cross ent: 	0.10342398663905598
	cluster: 	0.015366965023106373
	separation:	0.013545298001029082
	avg separation:	1.6215716988377318
	accu: 		96.88888888888889%
	l1: 		59.44261169433594
	p dist pair: 	3.586398124694824
	test
	time: 	6.572923898696899
	cross ent: 	0.13485575217361512
	cluster: 	0.011777021333967385
	separation:	0.011391368841654375
	avg separation:	1.5456122536408274
	accu: 		94.66666666666667%
	l1: 		59.44261169433594
	p dist pair: 	3.586398124694824
	above 50.00%
	push
	Executing push ...
	push time: 	88.41398406028748
	test
	time: 	6.549852132797241
	cross ent: 	1.3267589980050136
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		81.33333333333333%
	l1: 		59.44261169433594
	p dist pair: 	2.8168373107910156
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	49.24974966049194
	cross ent: 	0.8726871614206648
	cluster: 	0.0012216820242434475
	separation:	0.0007434055047624981
	avg separation:	1.214644594658056
	accu: 		84.71111111111111%
	l1: 		59.50312805175781
	p dist pair: 	2.8168373107910156
	test
	time: 	6.753466367721558
	cross ent: 	1.0035543780969947
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		84.53333333333333%
	l1: 		59.50312805175781
	p dist pair: 	2.8168373107910156
	above 50.00%
iteration: 	1
	train
	time: 	49.66372799873352
	cross ent: 	0.6368538878559129
	cluster: 	0.0012223072754378988
	separation:	0.0007427938006261706
	avg separation:	1.2146241224023717
	accu: 		88.0%
	l1: 		59.54228973388672
	p dist pair: 	2.8168373107910156
	test
	time: 	6.636157751083374
	cross ent: 	0.7913651197266421
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		87.2%
	l1: 		59.54228973388672
	p dist pair: 	2.8168373107910156
	above 50.00%
iteration: 	2
	train
	time: 	49.42134737968445
	cross ent: 	0.48795621424660945
	cluster: 	0.0012222290281537016
	separation:	0.0007422723839770363
	avg separation:	1.2153839930980164
	accu: 		90.28148148148148%
	l1: 		59.56591796875
	p dist pair: 	2.8168373107910156
	test
	time: 	6.516808271408081
	cross ent: 	0.6481244750933624
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		89.06666666666668%
	l1: 		59.56591796875
	p dist pair: 	2.8168373107910156
	above 50.00%
iteration: 	3
	train
	time: 	49.4599335193634
	cross ent: 	0.3870851176841868
	cluster: 	0.001221347954978384
	separation:	0.0007433159693251722
	avg separation:	1.2143723305160476
	accu: 		92.11851851851853%
	l1: 		59.58179473876953
	p dist pair: 	2.8168373107910156
	test
	time: 	6.968647241592407
	cross ent: 	0.5423116896203474
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		91.46666666666667%
	l1: 		59.58179473876953
	p dist pair: 	2.8168373107910156
	above 50.00%
iteration: 	4
	train
	time: 	49.199923038482666
	cross ent: 	0.3151703481056563
	cluster: 	0.0012223328599436263
	separation:	0.0007422136977389345
	avg separation:	1.215289471064799
	accu: 		93.27407407407408%
	l1: 		59.59095764160156
	p dist pair: 	2.8168373107910156
	test
	time: 	6.432919979095459
	cross ent: 	0.469215219019373
	cluster: 	0.0013293617950311226
	separation:	0.000974501241121049
	avg separation:	1.1604918868918168
	accu: 		92.53333333333333%
	l1: 		59.59095764160156
	p dist pair: 	2.8168373107910156
	above 50.00%
epoch: 	11
	joint
	train
	time: 	60.08923864364624
	cross ent: 	0.1131335122439495
	cluster: 	0.0074809276975537015
	separation:	0.006813230758640342
	avg separation:	1.2585911091262771
	accu: 		97.12592592592593%
	l1: 		59.59095764160156
	p dist pair: 	2.816173553466797
	test
	time: 	6.830219745635986
	cross ent: 	0.20147246386132842
	cluster: 	0.00835976205570133
	separation:	0.009261623368059335
	avg separation:	1.2106064181578786
	accu: 		96.0%
	l1: 		59.59095764160156
	p dist pair: 	2.816173553466797
	above 50.00%
epoch: 	12
	joint
	train
	time: 	60.3933002948761
	cross ent: 	0.0652596657739583
	cluster: 	0.005377189089549628
	separation:	0.005194425954863693
	avg separation:	1.264644714854878
	accu: 		98.25185185185185%
	l1: 		59.59095764160156
	p dist pair: 	2.824260950088501
	test
	time: 	6.743924379348755
	cross ent: 	0.14892442407098747
	cluster: 	0.0043922894095119675
	separation:	0.004003859504959301
	avg separation:	1.20432122130143
	accu: 		96.53333333333333%
	l1: 		59.59095764160156
	p dist pair: 	2.824260950088501
	above 50.00%
epoch: 	13
	joint
	train
	time: 	60.5528519153595
	cross ent: 	0.04819847704596768
	cluster: 	0.004020654869172171
	separation:	0.00368433851285799
	avg separation:	1.259463599447668
	accu: 		98.66666666666667%
	l1: 		59.59095764160156
	p dist pair: 	2.8181846141815186
	test
	time: 	6.843291759490967
	cross ent: 	0.1201860923320055
	cluster: 	0.0038217311161325165
	separation:	0.0034348940182673303
	avg separation:	1.2370873815134953
	accu: 		96.26666666666667%
	l1: 		59.59095764160156
	p dist pair: 	2.8181846141815186
	above 50.00%
epoch: 	14
	joint
	train
	time: 	60.22830939292908
	cross ent: 	0.03072775926307662
	cluster: 	0.004093277843988682
	separation:	0.003945855956976494
	avg separation:	1.2571359978625054
	accu: 		99.14074074074074%
	l1: 		59.59095764160156
	p dist pair: 	2.8166911602020264
	test
	time: 	6.571258068084717
	cross ent: 	0.20426354497229973
	cluster: 	0.0033621671609580517
	separation:	0.0035400658870409977
	avg separation:	1.1518480244435763
	accu: 		95.46666666666667%
	l1: 		59.59095764160156
	p dist pair: 	2.8166911602020264
	above 50.00%
epoch: 	15
	joint
	train
	time: 	60.25955677032471
	cross ent: 	0.019125131520008002
	cluster: 	0.0029682242683515218
	separation:	0.003012389734045729
	avg separation:	1.2457052864266571
	accu: 		99.67407407407407%
	l1: 		59.59095764160156
	p dist pair: 	2.819150686264038
	test
	time: 	6.680231332778931
	cross ent: 	0.13400532127860443
	cluster: 	0.0032211304274632744
	separation:	0.0035348591933909213
	avg separation:	1.1960159665659855
	accu: 		97.33333333333334%
	l1: 		59.59095764160156
	p dist pair: 	2.819150686264038
	above 50.00%
	push
	Executing push ...
	push time: 	87.2521984577179
	test
	time: 	6.470630645751953
	cross ent: 	0.3597892493646788
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		93.86666666666666%
	l1: 		59.59095764160156
	p dist pair: 	2.7713027000427246
	above 50.00%
	last layer
iteration: 	0
	train
	time: 	50.37449264526367
	cross ent: 	0.18080986508907726
	cluster: 	0.000811957949655373
	separation:	0.0008466122584133657
	avg separation:	1.2139424946181168
	accu: 		95.25925925925925%
	l1: 		59.59772491455078
	p dist pair: 	2.7713027000427246
	test
	time: 	7.138502359390259
	cross ent: 	0.3199102225480601
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		94.66666666666667%
	l1: 		59.59772491455078
	p dist pair: 	2.7713027000427246
	above 50.00%
iteration: 	1
	train
	time: 	49.280296087265015
	cross ent: 	0.14284592973351515
	cluster: 	0.0008117322296457994
	separation:	0.0008467063097663489
	avg separation:	1.2141565937967695
	accu: 		96.17777777777778%
	l1: 		59.60096740722656
	p dist pair: 	2.7713027000427246
	test
	time: 	6.84197735786438
	cross ent: 	0.28917376176870774
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		94.66666666666667%
	l1: 		59.60096740722656
	p dist pair: 	2.7713027000427246
	above 50.00%
iteration: 	2
	train
	time: 	49.29727220535278
	cross ent: 	0.11418165145472996
	cluster: 	0.0008116998758302043
	separation:	0.0008469914727136163
	avg separation:	1.213906732536632
	accu: 		96.5925925925926%
	l1: 		59.601688385009766
	p dist pair: 	2.7713027000427246
	test
	time: 	7.204100131988525
	cross ent: 	0.2637238624907025
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		94.93333333333334%
	l1: 		59.601688385009766
	p dist pair: 	2.7713027000427246
	above 50.00%
iteration: 	3
	train
	time: 	48.555105686187744
	cross ent: 	0.0927199049137226
	cluster: 	0.0008121656144407065
	separation:	0.0008461856422394779
	avg separation:	1.2144095509715334
	accu: 		97.15555555555555%
	l1: 		59.600894927978516
	p dist pair: 	2.7713027000427246
	test
	time: 	6.843509197235107
	cross ent: 	0.2437649548071357
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		94.93333333333334%
	l1: 		59.600894927978516
	p dist pair: 	2.7713027000427246
	above 50.00%
iteration: 	4
	train
	time: 	49.4091362953186
	cross ent: 	0.07674361814522412
	cluster: 	0.0008120196452984289
	separation:	0.0008465859222021946
	avg separation:	1.2145175909149577
	accu: 		97.86666666666667%
	l1: 		59.59794998168945
	p dist pair: 	2.7713027000427246
	test
	time: 	6.578370094299316
	cross ent: 	0.22673704325624336
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		95.19999999999999%
	l1: 		59.59794998168945
	p dist pair: 	2.7713027000427246
	above 50.00%
Early stop training because: (1) training acc convergend && (2) cluster cost is smaller then separation cost on training set
	test
	time: 	6.7495198249816895
	cross ent: 	0.22673704325624336
	cluster: 	0.001144944601324632
	separation:	0.0014935677754692733
	avg separation:	1.1554293601136458
	accu: 		95.19999999999999%
	l1: 		59.59794998168945
	p dist pair: 	2.7713027000427246
	above 50.00%
Execution time (minutes): 36.629333372910814
